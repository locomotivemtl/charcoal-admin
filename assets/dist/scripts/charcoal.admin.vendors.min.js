/*! @locomotivemtl/charcoal-admin 04-12-2017 */

function init_infoBox(){BB.gmap.infobox.prototype=new google.maps.OverlayView,BB.gmap.infobox.prototype.remove=function(){if(this._div){try{this._div.parentNode.removeChild(this._div)}catch(t){}this._div=null}},BB.gmap.infobox.prototype.set_map=function(t){this.__MAP=t,this.setMap(this.__MAP)},BB.gmap.infobox.prototype.map=function(){return this.__MAP},BB.gmap.infobox.prototype.draw=function(){this.createElement();var t=this.getProjection().fromLatLngToDivPixel(this.opts.position);t&&(this._div.style.width=this._width+"px",this._div.style.left=t.x+this._offsetX+"px",this._div.style.height=this._height+"px",this._div.style.top=t.y+this._offsetY+"px",this._div.style.display="block",this._div.style.zIndex=1)},BB.gmap.infobox.prototype.createElement=function(){var t=this.getPanes(),e=this._div;if(e){if(e.parentNode!=t.floatPane){try{e.parentNode.removeChild(e)}catch(t){}t.floatPane.appendChild(e)}}else{(e=this._div=document.createElement("div")).style.border="0",e.style.position="absolute",e.style.width=this._width+"px",e.style.height=this._height+"px",e.setAttribute("class","gmap_infobox"),e.appendChild(this.__ELEM),t.floatPane.appendChild(e),this._height=this.__ELEM.offsetHeight,this._width=this.__ELEM.offsetWidth;var i=this.opts.placement.split(" ");switch(i[0]){case"top":this._offsetY=-parseFloat(this.opts.offsetY);break;case"over":this._offsetY=-parseFloat(this.opts.offsetY)-parseInt(this._height);break;case"bottom":this._offsetY=-parseFloat(this._height);break;case"under":this._offsetY=0;break;case"center":this._offsetY=-parseFloat(this.opts.offsetY)/2-parseInt(this._height)/2}switch(i[1]){case"right":this._offsetX=parseFloat(this.opts.offsetX)-parseInt(this._width);break;case"left":this._offsetX=-parseFloat(this.opts.offsetX);break;case"center":this._offsetX=-parseInt(this._width)/2;break;case"out-right":this._offsetX=parseFloat(this.opts.offsetX);break;case"out-left":this._offsetX=-parseFloat(this.opts.offsetX)-parseInt(this._width)}this.panMap()}},BB.gmap.infobox.prototype.panMap=function(){var t=this.map,e=t.getBounds();if(e){var i=this.opts.position,o=this._width,n=this._height,s=this._offsetX,r=this._offsetY,a=t.getDiv(),l=a.offsetWidth,c=a.offsetHeight,h=e.toSpan(),p=h.lng()/l,u=h.lat()/c,d=(e.getSouthWest().lng(),e.getNorthEast().lng(),e.getNorthEast().lat(),e.getSouthWest().lat(),i.lng(),i.lng(),i.lat(),i.lat(),t.getCenter());if(!d||void 0===d)return!1;d.lng(),d.lat(),null!==this._bounds_changed_listener&&google.maps.event.removeListener(this._bounds_changed_listener),this._bounds_changed_listener=null}}}var URLSearchParams=URLSearchParams||function(){"use strict";function t(t){var o,s,r,a,l,c,p=Object.create(null);if(this[h]=p,t)if("string"==typeof t)for("?"===t.charAt(0)&&(t=t.slice(1)),l=0,c=(a=t.split("&")).length;l<c;l++)-1<(o=(r=a[l]).indexOf("="))?e(p,i(r.slice(0,o)),i(r.slice(o+1))):r.length&&e(p,i(r),"");else if(n(t))for(l=0,c=t.length;l<c;l++)e(p,(r=t[l])[0],r[1]);else for(s in t)e(p,s,t[s])}function e(t,e,i){e in t?t[e].push(""+i):t[e]=n(i)?i:[""+i]}function i(t){return decodeURIComponent(t.replace(a," "))}function o(t){return encodeURIComponent(t).replace(r,c)}var n=Array.isArray,s=t.prototype,r=/[!'\(\)~]|%20|%00/g,a=/\+/g,l={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},c=function(t){return l[t]},h="__URLSearchParams__:"+Math.random();s.append=function(t,i){e(this[h],t,i)},s.delete=function(t){delete this[h][t]},s.get=function(t){var e=this[h];return t in e?e[t][0]:null},s.getAll=function(t){var e=this[h];return t in e?e[t].slice(0):[]},s.has=function(t){return t in this[h]},s.set=function(t,e){this[h][t]=[""+e]},s.forEach=function(t,e){var i=this[h];Object.getOwnPropertyNames(i).forEach(function(o){i[o].forEach(function(i){t.call(e,i,o,this)},this)},this)},s.toJSON=function(){return{}},s.toString=function(){var t,e,i,n,s=this[h],r=[];for(e in s)for(i=o(e),t=0,n=s[e];t<n.length;t++)r.push(i+"="+o(n[t]));return r.join("&")};var p=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d=function(e){var i=e.append;e.append=s.append,t.call(e,e._usp.search.slice(1)),e.append=i},f=function(t,e){if(!(t instanceof e))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+e.name)},g=function(e){var i,o=e.prototype,n=u(o,"searchParams"),r=u(o,"href"),a=u(o,"search");!n&&a&&a.set&&(i=function(t){return function(e,i){return p(e,"_searchParams",{configurable:!0,writable:!0,value:t(i,e)}),i}}(function(t){function e(e,i){s.append.call(this,e,i),e=this.toString(),t.set.call(this._usp,e?"?"+e:"")}function i(e){s.delete.call(this,e),e=this.toString(),t.set.call(this._usp,e?"?"+e:"")}function o(e,i){s.set.call(this,e,i),e=this.toString(),t.set.call(this._usp,e?"?"+e:"")}return function(t,n){return t.append=e,t.delete=i,t.set=o,p(t,"_usp",{configurable:!0,writable:!0,value:n})}}(a)),Object.defineProperties(o,{href:{get:function(){return r.get.call(this)},set:function(t){var e=this._searchParams;r.set.call(this,t),e&&d(e)}},search:{get:function(){return a.get.call(this)},set:function(t){var e=this._searchParams;a.set.call(this,t),e&&d(e)}},searchParams:{get:function(){return f(this,e),this._searchParams||i(this,new t(this.search.slice(1)))},set:function(t){f(this,e),i(this,t)}}}))};return g(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&g(URL),t}();!function(t){var e=function(){try{return!!Symbol.iterator}catch(t){return!1}}();"forEach"in t||(t.forEach=function(t,e){var i=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(o){!o.length||o in i||(i[o]=this.getAll(o)).forEach(function(i){t.call(e,i,o,this)},this)},this)}),"keys"in t||(t.keys=function(){var t=[];this.forEach(function(e,i){t.push(i)});var i={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e&&(i[Symbol.iterator]=function(){return i}),i}),"values"in t||(t.values=function(){var t=[];this.forEach(function(e){t.push(e)});var i={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e&&(i[Symbol.iterator]=function(){return i}),i}),"entries"in t||(t.entries=function(){var t=[];this.forEach(function(e,i){t.push([i,e])});var i={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e&&(i[Symbol.iterator]=function(){return i}),i}),!e||Symbol.iterator in t||(t[Symbol.iterator]=t.entries),"sort"in t||(t.sort=function(){for(var t,e,i,o=this.entries(),n=o.next(),s=n.done,r=[],a=Object.create(null);!s;)e=(i=n.value)[0],r.push(e),e in a||(a[e]=[]),a[e].push(i[1]),s=(n=o.next()).done;for(r.sort(),t=0;t<r.length;t++)this.delete(r[t]);for(t=0;t<r.length;t++)e=r[t],this.append(e,a[e].shift())})}(URLSearchParams.prototype);var BB=BB||{};if(BB.base=function(){this.__BB_DEBUG__=!1,this.__PROTECTED__=[],this._data=void 0},BB.base.prototype.set_data=function(t){return void 0===this._data&&(this._data=new BB.data),"object"!=typeof t?this:(this._data.set_data(t),this)},BB.base.prototype.remove_data=function(t){return this._data.remove_data(t),this},BB.base.prototype.get_data=function(t){var e=this.data();return void 0!==e[t]&&e[t]},BB.base.prototype.data=function(t){return this._data.get_data(t)},BB.base.prototype.sanitize=function(){var t=this.data();return t=this._escape_data(t),this.set_data(t),this},BB.base.prototype._escape_data=function(t){if(void 0===t)return"";if("object"==typeof t&&t.length)for(var e=0,i=t.length;e<i;e++)t[e]=this._escape_data(t[e]);if("object"==typeof t)for(var o in t)t[o]=this._escape_data(t[o]);return"string"==typeof t?escape(t):t},BB.base.prototype._unescape_data=function(t){if(void 0===t)return"";if("object"==typeof t)for(var e in t)t[e]=this._unescape_data(t[e]);return"string"==typeof t?unescape(t):t},BB.base.prototype.ident=function(){var t=this.data();return"string"!=typeof t.ident?(this.error("Ident is not a String which is odd. "+t.ident),""):t.ident},BB.base.prototype.set_ident=function(t){return"string"!=typeof t&&(t=""+t,this.error("Ident must be a string. Automatically converted to : "+t)),this.set_data({ident:t}),this},BB.base.prototype.error=function(t){if(this.__BB_DEBUG__)throw Error(t);return this},BB.base.prototype.is_empty_object=function(t){if("object"!=typeof t)return this.error("Invalid argument, Object expected at BB.base.is_empty_object()"),!0;for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},BB.base.prototype.extend=function(t,e){var i,o={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(o[i]=e[i]);return o},(BB=BB||{}).data=function(t){if(this.__PROTECTED__=[],this.__HIDDEN_DATA__=!0,this.__HIDDEN_DATA__){var e=t||{};return{set_data:function(t){for(var i in t)e[i]=t[i]},get_data:function(t){return t?void 0!==e[t]?e[t]:"":e},remove_data:function(t){t||(e={}),void 0!==e[t]&&(e[t]=void 0,delete e[t])}}}return this.__DATA=t||{},this.set_data=function(t){if(this.__DATA){if(t)for(var e in t)this.__DATA[e]=t[e]}else this.__DATA=t||{}},this.get_data=function(t){return t?void 0!==this.__DATA[t]?this.__DATA[t]:void 0:this.__DATA},this.remove_data=function(t){t||(this.__DATA={}),void 0!==this.__DATA[t]&&(this.__DATA[t]=void 0,delete this.__DATA[t])},this},(BB=BB||{}).gmap=BB.gmap||{},BB.gmap.controller=function(t,e){return this._MAP=void 0,this.__CONTAINER=t,this.__EDITABLE=!1,this.__PLACES={markers:{},polygons:{},lines:{}},this.__FOCUSED_ITEM=void 0,this.__CLUSTERER=void 0,this.set_data(e),this},BB.gmap.controller.prototype=new BB.base,BB.gmap.controller.prototype.map=function(){return this._MAP?this._MAP:(this.error("No map associated to the current controller at BB.gmap.controller.map()"),!1)},BB.gmap.controller.prototype.loading_place=function(t){var e=this.get_place(t);return e?(e.set_data({loaded:!1}),this):this},BB.gmap.controller.prototype.place_loaded=function(t){return t?!t.data("loaded")&&(t.set_data({loaded:!0}),this.check_loaded_places()&&this._ready(),this):this},BB.gmap.controller.prototype.check_loaded_places=function(){var t=!0;return this._loop_all(function(e){t=!(!t||!e.data("loaded"))}),t=t&&this.data("tiles_loaded")},BB.gmap.controller.prototype.ready=function(t){return"function"==typeof t&&this.set_data({map_ready:t}),this},BB.gmap.controller.prototype._ready=function(){var t=this.data();return this.data("loaded")?this:("function"==typeof t.map_ready&&t.map_ready(this),this.set_data({loaded:!0}),this)},BB.gmap.controller.prototype.set_zoom=function(t){return this.map().setZoom(t),this},BB.gmap.controller.prototype.container=function(){return this.__CONTAINER},BB.gmap.controller.prototype.init=function(){var t=this.data();if(this.map())return this;var e=this.data("map");return e.center=new google.maps.LatLng(parseFloat(e.center.x),parseFloat(e.center.y)),this._MAP=new google.maps.Map(this.container(),e),"object"!=typeof t.places?this.error("You haven't set any places yet"):this.add_places(t.places),this.listeners(),this},BB.gmap.controller.prototype.set_styles=function(t){"object"!=typeof t&&this.error("Invalid type styles in BB.gmap.set_styles()"+t);var e=this.data("map");return e.styles=t,this.data("map",e),this.map()&&this.map().setOptions({styles:t}),this},BB.gmap.controller.prototype.add_places=function(t){if(!t)return this.error("Invalid places specified :"+t),this;for(var e in t)this.add_place(e,t[e]);return this},BB.gmap.controller.prototype.set_place=function(t,e,i){return e&&i?void 0===this.__PLACES[t]?(this.error("Invalid data type at BB.gmap.controlle.set_place( "+t+", "+e+", "+i+")"),this):(void 0===this.__PLACES[t][e]&&(this.__PLACES[t][e]={}),i.set_ident(e),this.__PLACES[t][e]=i,this):(this.error("Missing parameters in BB.gmap.controller.set_place( "+t+", "+e+", "+i+")"),this)},BB.gmap.controller.prototype.add_place=function(t,e){if(!e)return this.error("Missing parameter BB.gmap.controller.prototype.add_place ( ident, data ) : ( "+t+", "+e+" )"),this;if("string"!=typeof e.type)return this.error('Missing parameter "type" in BB.gmap.controller.prototype.add_place'),this;switch(e.ident=t,e.type){case"marker":i=new BB.gmap.marker(e,this),this.set_place("markers",t,i);break;case"richmarker":var i=new BB.gmap.richmarker(e,this);this.set_place("markers",t,i);break;case"line":this.set_place("lines",t,new BB.gmap.line(e,this));break;case"polygon":this.set_place("polygons",t,new BB.gmap.polygon(e,this))}return this},BB.gmap.controller.prototype.get_places=function(){return this.__PLACES},BB.gmap.controller.prototype.get_places_by_type=function(t){return this.__PLACES[t]},BB.gmap.controller.prototype.add_place_by_address=function(t,e,i){var o=this;this.geocode_address(e,function(e){i.coords=e,o.add_place(t,i)})},BB.gmap.controller.prototype.geocode_address=function(t,e){var i=Array();if("undefined"==typeof google)return error;(new google.maps.Geocoder).geocode({address:t},function(t,o){if(o==google.maps.GeocoderStatus.OK){var n=t[0].geometry.location.lat(),s=t[0].geometry.location.lng();"function"==typeof e&&e([n,s])}return i})},BB.gmap.controller.prototype.get_place=function(t){var e=this.get_places(),i=!1;for(var o in e){var n=this.get_places_by_type(o);this.is_empty_object(n)||(i="object"==typeof n[t]?n[t]:i)}return i||(this.error("Invalid ident at BB.gmap.controller.get_place( ident ) : "+t),!1)},BB.gmap.controller.prototype.remove_focus=function(){var t=this.focused();return t&&("function"==typeof this.data("onblur")&&this.data("onblur")(t,this),t.blur(),this.__FOCUSED_ITEM=void 0),this},BB.gmap.controller.prototype.set_focus=function(t){return this.remove_focus(),this.__FOCUSED_ITEM=t,"function"==typeof this.data("onfocus")&&this.data("onfocus")(t,this),this},BB.gmap.controller.prototype.focused=function(){return this.__FOCUSED_ITEM},BB.gmap.controller.prototype.translate_coords=function(t){if("object"==typeof t&&2==t.length)return new google.maps.LatLng(t[0],t[1])},BB.gmap.controller.prototype.listeners=function(){var t=this;return google.maps.event.clearListeners(this.map(),"click"),google.maps.event.addListener(this.map(),"click",function(e){t.map_click(e)}),google.maps.event.addListenerOnce(this.map(),"tilesloaded",function(e){t.set_data({tiles_loaded:!0}),t._ready()}),google.maps.event.addDomListener(document,"keyup",function(e){switch(e.keyCode?e.keyCode:e.which){case 46:t.focused()&&t.focused().data("editable")&&(t.focused().delete(),t.remove_focus());break;case 27:t.focused()&&t.remove_focus()}}),this},BB.gmap.controller.prototype.create_new=function(t,e){e||(e="new_object");var i=this.data("default_styles");switch(i||(i={strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FFFFFF",fillOpacity:.35,hover:{strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FFFFFF",fillOpacity:1},focused:{fillOpacity:1}}),t){case"polygon":var o={type:"polygon",editable:!0,styles:i},n=new BB.gmap.polygon(o,this);this.set_place("polygons",e,n),this.set_focus(n);break;case"line":var o={type:"line",editable:!0,styles:i},s=new BB.gmap.line(o,this);this.set_place("lines",e,s),this.set_focus(s);break;default:this.set_data({marker_creation:e})}},BB.gmap.controller.prototype.on=function(t,e){var i={};i["on"+t]=e,this.set_data(i)},BB.gmap.controller.prototype.map_click=function(t){this.data("marker_creation")&&(this.add_place(this.data("marker_creation"),{coords:[t.latLng.lat(),t.latLng.lng()],draggable:!0,editable:!0,type:"marker"}),this.set_focus(this.get_place(this.data("marker_creation"))),"function"==typeof this.data("marker_creation_callback")&&this.data("marker_creation_callback")(this.get_place(this.data("marker_creation"))),this.set_data({marker_creation:!1}));var e=this.focused();return e?(e.data("editable")?e.map_click(t):this.remove_focus(),this):this},BB.gmap.controller.prototype._loop_all=function(t){if("function"!=typeof t)return this;var e=this.get_places();for(var i in e){var o=this.get_places_by_type(i);if(!this.is_empty_object(o))for(var n in o)t(o[n])}return this},BB.gmap.controller.prototype.filter=function(t){this._loop_all(function(e){if(!t)return e.show(),!1;var i=e.data("categories");if(!i)return e.hide(),!1;"string"==typeof i&&(i=i.split(",")),i||e.hide();var o=!1;for(var n in i)t==i[n]&&(o=!0);o?e.show():e.hide()})},BB.gmap.controller.prototype.fit_bounds=function(){var t=new google.maps.LatLngBounds,e=0;if(this._loop_all(function(i){var o=i.get_position();if(!o)return!1;for(var n,s=0;s<o.getLength();s++){n=o.getAt(s);for(var r=0;r<n.getLength();r++)t.extend(n.getAt(r))}e++}),e>0&&(this.map().fitBounds(t),this.data("max_fitbounds_zoom"))){var i=this.data("max_fitbounds_zoom");this.map().getZoom()>i&&this.map().setZoom(i)}return this},BB.gmap.controller.prototype.get_all_markers=function(){var t=this.get_places_by_type("markers"),e=[];for(var i in t)e.push(t[i].object());return e},BB.gmap.controller.prototype.activate_clusterer=function(t){this.clusterer()&&this.clusterer().clearMarkers();var e=this.get_all_markers();return this.set_clusterer(new MarkerClusterer(this.map(),e)),this},BB.gmap.controller.prototype.set_clusterer=function(t){this.__CLUSTERER=t},BB.gmap.controller.prototype.clusterer=function(){return this.__CLUSTERER},BB.gmap.controller.prototype._delete=function(t,e){switch(t){case"marker":if(void 0===this.__PLACES.markers[e])return!1;delete this.__PLACES.markers[e];break;case"line":if(void 0===this.__PLACES.lines[e])return!1;delete this.__PLACES.lines[e];break;case"polygon":if(void 0===this.__PLACES.polygons[e])return!1;delete this.__PLACES.polygons[e]}},BB.gmap.controller.prototype.export=function(){var t=this.data();void 0!==t.places&&delete t.places,void 0!==t.center&&delete t.center;var e=this.map().getCenter();return t.map.center.x=e.lat(),t.map.center.y=e.lng(),t.map.zoom=this.map().getZoom(),t.places={},this._loop_all(function(e){t.places[e.ident()]=e.export()}),t},BB.gmap.controller.prototype.get_map_image=function(){var t=this.data();void 0!==t.places&&delete t.places,void 0!==t.center&&delete t.center;var e=this.map().getCenter(),i="https://maps.googleapis.com/maps/api/staticmap?",o=[];return o.push("center="+e.lat()+","+e.lng()),o.push("zoom="+this.map().getZoom()),o.push("size=640x400"),this._loop_all(function(t){if("marker"==t.data("type")){if(!t.data("icon").src)return!1;var e=new Image;e.src=t.data("icon").src;var i=t.data("icon").width+"x"+t.data("icon").height,n=t.data("coords"),s="markers=size:"+i+"|icon:"+e.src+"|"+n[0]+","+n[1];o.push(s)}if("polygon"==t.data("type")){var r=t.data("paths");if(!r)return!1;var a=[],l=t.data("styles"),c=(l.strokeColor,l.strokeWeight);l.fillColor,a.push("color:black"),a.push("weight:"+c),a.push("fillcolor:white");for(var h=0,p=r.length;h<p;h++)a.push(r[h].join(","));a.push(r[0].join(",")),o.push("path="+a.join("|"))}}),i+=o.join("&")},BB.gmap.controller.prototype.reset=function(){return this._loop_all(function(t){t.hide(),t.delete()}),this.set_data({places:void 0}),this.remove_focus(),this},(BB=BB||{}).gmap=BB.gmap||{},BB.gmap.statics=BB.gmap.statics||{},BB.gmap.infobox=function(t,e){BB.gmap.statics,this.__MAP=void 0,t instanceof jQuery&&(t=t.get(0)),this.__ELEM=t,google.maps.OverlayView.call(this),e.offsetY=e.offsetY||0,e.offsetX=e.offsetX||0,this.opts=e,void 0===this.opts.placement&&(this.opts.placement="top center"),this.__MAP=e.map;var i=this;this._bounds_changed_listener=google.maps.event.addListener(this.__MAP,"bounds_changed",function(){return i.panMap.apply(i)}),this.set_map(e.map)},(BB=BB||{}).gmap=BB.gmap||{},BB.gmap.object=function(t,e){return this.__OBJECT=void 0,this.__CONTROLLER=e,this.__DELETED=!1,this.set_data(t),this.init(),this.controller().loading_place(this.ident()),this},BB.gmap.object.prototype=new BB.base,BB.gmap.object.prototype.set_object=function(t){return this.__OBJECT=t,this},BB.gmap.object.prototype.object=function(){return this.__OBJECT},BB.gmap.object.prototype.controller=function(){return this.__CONTROLLER},BB.gmap.object.prototype.set_controller=function(t){return this.__CONTROLLER=t,this},BB.gmap.object.prototype.set_map=function(t){return this.object().setMap(t),this},BB.gmap.object.prototype.map_click=function(t){return this},BB.gmap.object.prototype.show=function(){var t=this.object();return void 0===t?(this.error("No object defined at BB.gmap.object.show()"),this):(t.setMap(this.controller().map()),this)},BB.gmap.object.prototype.hide=function(){var t=this.object();return void 0===t?(this.error("No object defined at BB.gmap.object.hide()"),this):(t.setMap(null),this)},BB.gmap.object.prototype.delete=function(){this.__DELETED=!0;var t=this.object();if(void 0===t)return this.error("No object defined at BB.gmap.object.delete()"),this;this.clear_listeners(),t.setMap(null);var e=this.data();return"function"==typeof e.ondelete&&e.ondelete(this),this.controller()._delete(this.data("type"),this.ident()),delete t,this},BB.gmap.object.prototype.init=function(){return this},BB.gmap.object.prototype.display=function(){return this},BB.gmap.object.prototype.focus=function(){return this},BB.gmap.object.prototype.blur=function(){return this},BB.gmap.object.prototype.get_bounds=function(){return this},BB.gmap.object.prototype.get_position=function(){return this},BB.gmap.object.prototype.clear_listeners=function(){return this},BB.gmap.object.prototype.export=function(){return this.data()},(BB=BB||{}).gmap=BB.gmap||{},BB.gmap.statics=BB.gmap.statics||{},BB.gmap.marker=function(t,e){return BB.gmap.object.call(this,t,e),this.__MEDIA=void 0,this.__ICON=void 0,this._image_loaded=!1,this._marker_loaded=!1,this.__INFOBOX=void 0,this._listeners=!1,this},BB.gmap.marker.prototype=Object.create(BB.gmap.object.prototype),BB.gmap.marker.prototype.init=function(){var t=this.data();return"string"==typeof t.icon?this.set_image(t.icon):"object"==typeof t.icon?this.set_icon(t.icon):this.display(),this},BB.gmap.marker.prototype.icon=function(){return this.__ICON?this.__ICON:new Image},BB.gmap.marker.prototype.set_icon=function(t){if("object"!=typeof t)return this.error("Invalid icon at BB.gmap.marker.prototype.set_icon( "+t+" )"),this;if(!(t instanceof Image)&&void 0===t.path){var e;return t.width&&t.height&&(e={width:t.width,height:t.height}),this.set_image(t.src,e),this}return this.__ICON=t,this.display(),this},BB.gmap.marker.prototype.set_image=function(t,e){var i=new Image;return i.data=this,i.onload=function(){this.data.set_icon(this),this.data.display()},i.onerror=function(){this.data.set_data({icon:void 0}),this.data.display()},i.src=t,e&&(i.height=e.height,i.width=e.width),this},BB.gmap.marker.prototype.display=function(){var t=this.data();if("object"!=typeof t.coords)return this.error("Requires coordinates [lat, lng] at BB.gmap.marker.display()"),!1;var e={map:this.controller().map(),position:new google.maps.LatLng(t.coords[0],t.coords[1])};e=this.extend(e,t);var i=this.icon();if(!(i instanceof Image)&&"string"==typeof i.path){var o=0,n=0;"string"==typeof i.height&&(o=parseInt(i.height)),"string"==typeof i.width&&(n=parseInt(i.width)),i.anchor=new google.maps.Point(n/2,o),e.icon=i}var s="object"==typeof t.options?t.options:{};for(var r in s)e[r]=s[r];if(this.icon().src){var n=this.icon().width,o=this.icon().height;e.icon=new google.maps.MarkerImage(this.icon().src,new google.maps.Size(n,o),new google.maps.Point(0,0),new google.maps.Point(n/2,o),new google.maps.Size(n,o))}if(void 0!==this.object())this.object().setOptions(e);else{var a=new google.maps.Marker(e);this.set_marker(a)}return this._listeners||(this.listeners(),this._listeners=!0,this.marker_loaded()),this.data("hidden")&&this.hide(),this},BB.gmap.marker.prototype.marker_loaded=function(){var t=this.data();return"function"==typeof t.loaded_callback&&t.loaded_callback(this),this.controller().data("use_clusterer")&&(this.controller().data("clusterer_options"),this.controller().activate_clusterer({gridSize:10,maxZoom:15})),this.controller().place_loaded(this),this},BB.gmap.marker.prototype.set_marker=function(t){return this._marker_loaded?(this.error("There is already a marker affected to this instanciation of a [BB.gmap.marker] ( "+this.ident()+" )"),this):(this._marker_loaded=!0,this.set_object(t),this)},BB.gmap.marker.prototype.listeners=function(){var t=this.object();t.bbmarker=this,this.data("draggable")&&google.maps.event.addListener(t,"dragend",this.dragend),google.maps.event.addListener(t,"click",this.onclick)},BB.gmap.marker.prototype.clear_listeners=function(){var t=this.object();return google.maps.event.clearListeners(t,"dragend"),google.maps.event.clearListeners(t,"click"),this},BB.gmap.marker.prototype.dragend=function(t){var e=this.bbmarker,i=e.data();"function"==typeof i.ondragend&&i.ondragend(e,t),e.set_data({coords:[t.latLng.lat(),t.latLng.lng()]}),e.focus()},BB.gmap.marker.prototype.onclick=function(t){var e=this.bbmarker,i=e.data();if("function"==typeof i.onclick?i.onclick(t,e):"string"==typeof i.onclick&&"function"==typeof window[i.onclick]&&window[i.onclick](e,t),i.infobox){if(e.__INFOBOX)return e.__INFOBOX.map?e.__INFOBOX.set_map(null):e.__INFOBOX.set_map(e.controller().map()),e.focus(),this;if(BB.gmap.statics.infobox_loaded||(init_infoBox(),BB.gmap.statics.infobox_loaded=!0),"function"==typeof i.infobox&&(i.infobox=i.infobox(e.data())),"string"==typeof i.infobox){var o=document.getElementById(i.infobox);o||((o=document.createElement("div")).style.position="absolute",o.innerHTML=i.infobox),i.infobox=o}var n={};i.infobox_options&&(n=i.infobox_options),n.offsetY||(n.offsetY=e.icon().height),n.offsetX||(n.offsetX=e.icon().width/2),n.map=e.controller().map(),n.position=e.get_position().getAt(0).getAt(0),e.__INFOBOX=new BB.gmap.infobox(i.infobox,n)}e.focus()},BB.gmap.marker.prototype.focus=function(){this.controller().set_focus(this);var t=this.data();t.icon_selected&&("object"==typeof t.icon_selected?this.set_icon(t.icon_selected):this.set_image(t.icon_selected))},BB.gmap.marker.prototype.blur=function(){if(!this.controller().get_place(this.ident()))return!1;var t=this.data();t.icon_selected&&("object"==typeof t.icon?this.set_icon(t.icon):this.set_image(t.icon))},BB.gmap.marker.prototype.get_bounds=function(){var t=new google.maps.LatLngBounds;return t.extend(this.object().getPosition()),t},BB.gmap.marker.prototype.get_position=function(){var t=new google.maps.MVCArray,e=new google.maps.MVCArray;return!!this.object()&&(t.push(this.object().getPosition()),e.push(t),e)},(BB=BB||{}).gmap=BB.gmap||{},BB.gmap.statics=BB.gmap.statics||{},BB.gmap.richmarker=function(t,e){return BB.gmap.marker.call(this,t,e),this._listeners=!1,this},BB.gmap.richmarker.prototype=Object.create(BB.gmap.marker.prototype),BB.gmap.richmarker.prototype.init=function(){var t=this.data();return this.set_content(t.content),this.display(),this},BB.gmap.richmarker.prototype.set_content=function(t){return this._content=t,this},BB.gmap.richmarker.prototype.content=function(){return this._content},BB.gmap.richmarker.prototype.display=function(){var t=this.data();if("object"!=typeof t.coords)return this.error("Requires coordinates [lat, lng] at BB.gmap.richmarker.display()"),!1;var e={map:this.controller().map(),position:new google.maps.LatLng(t.coords[0],t.coords[1])};if("function"==typeof(e=this.extend(e,t)).html&&(console.log(e.html(t)),e.html=e.html(t)),"function"==typeof e.selected_html&&(e.selected_html=e.selected_html(t)),void 0!==this.object())this.object().setOptions(e);else{var i=customMarker(e);this.set_marker(i)}return this._listeners||(this.listeners(),this._listeners=!0),this.data("hidden")&&this.hide(),this},BB.gmap.richmarker.prototype.listeners=function(){var t=this.object();t.bbmarker=this,this.data("draggable")&&google.maps.event.addListener(t,"dragend",this.dragend),google.maps.event.addListener(t,"click",this.onclick)},BB.gmap.richmarker.prototype.clear_listeners=function(){var t=this.object();return google.maps.event.clearListeners(t,"dragend"),google.maps.event.clearListeners(t,"click"),this},BB.gmap.richmarker.prototype.focus=function(){if(this.controller().focused()&&this.controller().focused().ident()==this.ident())return this;this.controller().set_focus(this),this.object().setHtml(this.data("selected_html"))},BB.gmap.richmarker.prototype.blur=function(){if(!this.controller().get_place(this.ident()))return!1;this.object().setHtml(this.data("html"))},BB.gmap.richmarker.prototype.icon=function(){return{height:this.object().div.offsetHeight,width:this.object().div.offsetWidth}},customMarker=function(t){return"function"!=typeof BB.gmap.customMarker&&(BB.gmap.customMarker=function(t){this.MAP=t.map,void 0!==t.map&&this.setMap(this.MAP),void 0!==t.position&&(this.latlng=t.position),void 0!==t.html&&(this.html=t.html)},BB.gmap.customMarker.prototype=new google.maps.OverlayView,BB.gmap.customMarker.prototype.draw=function(){this.setHtml(this.html)},BB.gmap.customMarker.prototype.setHtml=function(t){var e=this,i=this.div;i||((i=document.createElement("div")).style.position="absolute",i.style.cursor="pointer",google.maps.event.addDomListener(i,"click",function(t){t.stopPropagation(),t.preventDefault(),google.maps.event.trigger(e,"click")}),this.getPanes().overlayImage.appendChild(i)),i.innerHTML=this.html;var o=this.getProjection().fromLatLngToDivPixel(this.latlng);if(o){var n=i.offsetHeight,s=i.offsetWidth;i.style.left=o.x-s/2+"px",i.style.top=o.y-n+"px"}this.div=i},BB.gmap.customMarker.prototype.remove=function(){this.div&&(this.div.parentNode.removeChild(this.div),this.div=null)},BB.gmap.customMarker.prototype.getPosition=function(){return this.latlng}),new BB.gmap.customMarker(t)},(BB=BB||{}).gmap=BB.gmap||{},BB.gmap.line=function(t,e){return this.__STYLES=void 0,this.__PATHS=void 0,this.__MARKERS=[],BB.gmap.object.call(this,t,e),this},BB.gmap.line.prototype=Object.create(BB.gmap.object.prototype),BB.gmap.line.prototype.init=function(){var t=this.data();if("object"!=typeof t.styles&&this.set_data({styles:this.controller().data("default_styles")}),this.add_styles(t.styles),this.set_paths([]),"object"==typeof t.paths)for(var e=0,i=t.paths.length;e<i;e++)this.add_point(t.paths[e]);return this.get_paths()&&this.get_styles()&&this.display(),t.editable&&this.set_editable(t.editable),this.listeners(),this.controller().place_loaded(this),this},BB.gmap.line.prototype.redraw=function(){for(var t=this.get_paths(),e=0,i=t.length,o=[];e<i;e++)o.push([t.getAt(e).lat(),t.getAt(e).lng()]);this.set_data({paths:o})},BB.gmap.line.prototype.add_styles=function(t){this.__STYLES=t},BB.gmap.line.prototype.set_styles=function(t){return this.add_styles(t),this.display(),this},BB.gmap.line.prototype.get_styles=function(){return this.__STYLES},BB.gmap.line.prototype.set_paths=function(t){if("object"==typeof t){if(!(t[0]instanceof google.maps.LatLng)){for(var e=0,i=t.length,o=new google.maps.MVCArray;e<i&&"object"==typeof t[e];e++){var n=this.controller().translate_coords(t[e]);o.insertAt(o.length,n)}t=o}this.__PATHS=t}else this.error("Invalid paths at BB.gmap.line.set_paths :"+t)},BB.gmap.line.prototype.get_paths=function(){return this.__PATHS},BB.gmap.line.prototype.display=function(){this.data();var t=this.get_styles();void 0===t&&this.error("Undefined styles at BB.gmap.line.display : "+t);var e=this.get_paths();if(void 0===e&&this.error("Undefined paths at BB.gmap.line.display : "+e),t.path=e,void 0!==this.object())this.object().setOptions(t);else{var i=new google.maps.Polyline(t);this.set_object(i)}return this.set_map(this.controller().map()),this.update_coords(),this},BB.gmap.line.prototype.refresh=function(){var t=this.data("_opts");this.object().setOptions(t)},BB.gmap.line.prototype.add_point=function(t,e){if("object"!=typeof t)return!1;if(t instanceof google.maps.LatLng||(t=this.controller().translate_coords(t)),!(t instanceof google.maps.LatLng||void 0!==t[0]&&void 0!==t[1]))return!1;var i=this,o=this.get_paths();void 0===o&&this.set_paths([[t.lat(),t.lng()]]),o=this.get_paths(),"number"!=typeof e&&(e=o.length),o.insertAt(e,t);var n=new BB.gmap.marker({coords:[t.lat(),t.lng()],draggable:!0,icon:{path:google.maps.SymbolPath.CIRCLE,scale:4},hidden:!this.data("editable"),editable:!0,ondragend:function(t,e){i.move_point(t.object().index,[e.latLng.lat(),e.latLng.lng()])},ondelete:function(t){i.remove_point(t.object().index),i.focus(),i.get_paths().length||i.delete()},index:e},i.controller());return this.__MARKERS||(this.__MARKERS=[]),this.__MARKERS[e]=n,this},BB.gmap.line.prototype.move_point=function(t,e){var i=this.get_paths();return"object"!=typeof i?(this.error("You can not move a point when no path is given at BB.gmap.line.move_point( index, path )"),!1):e?(e instanceof google.maps.LatLng||(e=this.controller().translate_coords(e)),(e instanceof google.maps.LatLng||void 0!==e[0]&&void 0!==e[1])&&(i.setAt(t,e),this.update_coords(),this)):(this.error("Required arguments index:integer and path:object at BB.gmap.line.move_point( index, path )"),!1)},BB.gmap.line.prototype.remove_point=function(t){var e=this.get_paths();if("object"!=typeof e)return this.error("You can not move a point when no path is given at BB.gmap.line.remove_point( index, path )"),!1;e.removeAt(t),void 0!==this.__MARKERS[t]&&(this.__MARKERS[t].hide(),this.__MARKERS.splice(t,1));var i=this.__MARKERS;for(var o in i)i[o].object().index=parseInt(o);return this.redraw(),this.update_coords(),this},BB.gmap.line.prototype.set_editable=function(t){return t?(this.set_data({editable:!0}),this.show_markers(),this.focus(),this):(this.set_data({editable:!1}),this.hide_markers(),this)},BB.gmap.line.prototype.show_markers=function(){for(var t=0;t<this.__MARKERS.length;t++)this.__MARKERS[t].show();return this},BB.gmap.line.prototype.hide_markers=function(){this.controller().focused();for(var t=0;t<this.__MARKERS.length;t++)this.__MARKERS[t].hide();return this},BB.gmap.line.prototype.map_click=function(t){this.add_point(t.latLng)},BB.gmap.line.prototype.set_draggable=function(t){var e=this.get_styles();return e.draggable=!!t,this.set_styles(e),this},BB.gmap.line.prototype.listeners=function(){this.object().bbobject=this,this.clear_listeners(),google.maps.event.addListener(this.object(),"mouseover",this.mouse_over),google.maps.event.addListener(this.object(),"mouseout",this.mouse_out),google.maps.event.addListener(this.object(),"click",this.click)},BB.gmap.line.prototype.clear_listeners=function(){return google.maps.event.clearListeners(this.object(),"mouseover"),google.maps.event.clearListeners(this.object(),"mouseout"),google.maps.event.clearListeners(this.object(),"click"),this},BB.gmap.line.prototype.mouse_over=function(t){var e=this.bbobject,i=e.data();"function"==typeof i.onmouseover&&i.onmouseover(e,t);var o=e.get_styles();"object"==typeof o.hover&&e.set_styles(o.hover)},BB.gmap.line.prototype.mouse_out=function(t){var e=this.bbobject,i=e.data();if("function"==typeof i.onmouseout&&i.onmouseout(e,t),e.controller().focused()==e)return!1;e.get_data("styles"),e.set_styles(e.get_data("styles"))},BB.gmap.line.prototype.mouse_down=function(t){this.bbobject},BB.gmap.line.prototype.mouse_up=function(t){this.bbobject},BB.gmap.line.prototype.click=function(t){var e=this.bbobject,i=e.data();e.focus(),"function"==typeof i.onclick?i.onclick(e,t):"string"==typeof i.onclick&&"function"==typeof window[i.onclick]&&window[i.onclick](e,t)},BB.gmap.line.prototype.focus=function(){if(this.__DELETED)return!1;this.controller().set_focus(this);var t=this.get_data("styles");return"object"==typeof t.focused&&this.set_styles(t.focused),this.data("editable")&&this.show_markers(),this},BB.gmap.line.prototype.blur=function(){return!this.__DELETED&&(this.set_styles(this.get_data("styles")),this)},BB.gmap.line.prototype.get_bounds=function(){for(var t,e=new google.maps.LatLngBounds,i=this.object().getPaths(),o=0;o<i.getLength();o++){t=i.getAt(o);for(var n=0;n<t.getLength();n++)e.extend(t.getAt(n))}return e},BB.gmap.line.prototype.get_position=function(){var t=new google.maps.MVCArray;return t.push(this.object().getPath()),t},BB.gmap.line.prototype.update_coords=function(){var t=[];return this.get_paths().forEach(function(e){t.push([e.lat(),e.lng()])}),this.set_data({paths:t}),this},BB.gmap.line.prototype.export=function(){this.update_coords();var t=this.data();return void 0!==t.styles.path&&delete t.styles.path,this.data()},BB.gmap.line.prototype.delete=function(){var t=0,e=this.__MARKERS.length;if(e)for(;t<e;t++)this.remove_point(t);this.hide_markers(),BB.gmap.object.prototype.delete.call(this)},(BB=BB||{}).gmap=BB.gmap||{},BB.gmap.polygon=function(t,e){return BB.gmap.line.call(this,t,e),this},BB.gmap.polygon.prototype=Object.create(BB.gmap.line.prototype),BB.gmap.polygon.prototype.display=function(){this.data();var t=this.get_styles();void 0===t&&this.error("Undefined styles at BB.gmap.polygon.display : "+t);var e=this.get_paths();if(void 0===e&&this.error("Undefined paths at BB.gmap.polygon.display : "+e),void 0!==this.object())this.object().setOptions(t);else{var i=new google.maps.Polygon(t);this.set_object(i)}return this.object().setPaths(new google.maps.MVCArray([e])),this.set_map(this.controller().map()),this.listeners(),this},BB.gmap.polygon.prototype.get_position=function(){return this.object().getPaths()},function(){function t(t){return function(e){this[t]=e}}function e(t){return function(){return this[t]}}function i(t,e,o){this.extend(i,google.maps.OverlayView),this.c=t,this.a=[],this.f=[],this.ca=[53,56,66,78,90],this.j=[],this.A=!1,o=o||{},this.g=o.gridSize||60,this.l=o.minimumClusterSize||2,this.J=o.maxZoom||d,this.j=o.styles||[],this.X=o.imagePath||this.Q,this.W=o.imageExtension||this.P,this.O=!0,void 0!=o.zoomOnClick&&(this.O=o.zoomOnClick),this.r=!1,void 0!=o.averageCenter&&(this.r=o.averageCenter),function(t){if(!t.j.length)for(var e,i=0;e=t.ca[i];i++)t.j.push({url:t.X+(i+1)+"."+t.W,height:e,width:e})}(this),this.setMap(t),this.K=this.c.getZoom();var n=this;google.maps.event.addListener(this.c,"zoom_changed",function(){var t=n.c.getZoom();n.K!=t&&(n.K=t,n.m())}),google.maps.event.addListener(this.c,"idle",function(){n.i()}),e&&e.length&&this.C(e,!1)}function o(t,e){e.s=!1,e.draggable&&google.maps.event.addListener(e,"dragend",function(){e.s=!1,t.L()}),t.a.push(e)}function n(t,e){var i=-1;if(t.a.indexOf)i=t.a.indexOf(e);else for(var o,n=0;o=t.a[n];n++)if(o==e){i=n;break}return-1!=i&&(e.setMap(d),t.a.splice(i,1),!0)}function s(t){if(t.A)for(var e,i=t.v(new google.maps.LatLngBounds(t.c.getBounds().getSouthWest(),t.c.getBounds().getNorthEast())),o=0;e=t.a[o];o++)if(!e.s&&i.contains(e.getPosition())){for(var n=t,s=4e4,a=d,l=0,c=void 0;c=n.f[l];l++)if(f=c.getCenter()){var h=e.getPosition();if(f&&h)var p=(h.lat()-f.lat())*Math.PI/180,u=(h.lng()-f.lng())*Math.PI/180,f=Math.sin(p/2)*Math.sin(p/2)+Math.cos(f.lat()*Math.PI/180)*Math.cos(h.lat()*Math.PI/180)*Math.sin(u/2)*Math.sin(u/2),f=12742*Math.atan2(Math.sqrt(f),Math.sqrt(1-f));else f=0;f<s&&(s=f,a=c)}a&&a.F.contains(e.getPosition())?a.q(e):((c=new r(n)).q(e),n.f.push(c))}}function r(t){this.k=t,this.c=t.getMap(),this.g=t.w(),this.l=t.l,this.r=t.r,this.d=d,this.a=[],this.F=d,this.n=new l(this,t.z(),t.w())}function a(t){t.F=t.k.v(new google.maps.LatLngBounds(t.d,t.d))}function l(t,e,i){t.k.extend(l,google.maps.OverlayView),this.j=e,this.fa=i||0,this.u=t,this.d=d,this.c=t.getMap(),this.B=this.b=d,this.t=!1,this.setMap(this.c)}function c(t,e){var i=t.getProjection().fromLatLngToDivPixel(e);return i.x-=parseInt(t.p/2,10),i.y-=parseInt(t.h/2,10),i}function h(t){t.b&&(t.b.style.display="none"),t.t=!1}function p(t,e){var i=[];return i.push("background-image:url("+t.da+");"),i.push("background-position:"+(t.D?t.D:"0 0")+";"),"object"==typeof t.e?("number"==typeof t.e[0]&&t.e[0]>0&&t.e[0]<t.h?i.push("height:"+(t.h-t.e[0])+"px; padding-top:"+t.e[0]+"px;"):i.push("height:"+t.h+"px; line-height:"+t.h+"px;"),"number"==typeof t.e[1]&&t.e[1]>0&&t.e[1]<t.p?i.push("width:"+(t.p-t.e[1])+"px; padding-left:"+t.e[1]+"px;"):i.push("width:"+t.p+"px; text-align:center;")):i.push("height:"+t.h+"px; line-height:"+t.h+"px; width:"+t.p+"px; text-align:center;"),i.push("cursor:pointer; top:"+e.y+"px; left:"+e.x+"px; color:"+(t.M?t.M:"black")+"; position:absolute; font-size:"+(t.N?t.N:11)+"px; font-family:Arial,sans-serif; font-weight:bold"),i.join("")}var u,d=null;(u=i.prototype).Q="https://raw.githubusercontent.com/googlemaps/js-marker-clusterer/gh-pages/images/m",u.P="png",u.extend=function(t,e){return function(t){for(var e in t.prototype)this.prototype[e]=t.prototype[e];return this}.apply(t,[e])},u.onAdd=function(){this.A||(this.A=!0,s(this))},u.draw=function(){},u.S=function(){for(var t,e=this.o(),i=new google.maps.LatLngBounds,o=0;t=e[o];o++)i.extend(t.getPosition());this.c.fitBounds(i)},u.z=e("j"),u.o=e("a"),u.V=function(){return this.a.length},u.ba=t("J"),u.I=e("J"),u.G=function(t,e){for(var i=0,o=t.length,n=o;0!==n;)n=parseInt(n/10,10),i++;return i=Math.min(i,e),{text:o,index:i}},u.$=t("G"),u.H=e("G"),u.C=function(t,e){for(var i,n=0;i=t[n];n++)o(this,i);e||this.i()},u.q=function(t,e){o(this,t),e||this.i()},u.Y=function(t,e){var i=n(this,t);return!(e||!i||(this.m(),this.i(),0))},u.Z=function(t,e){for(var i,o=!1,s=0;i=t[s];s++)i=n(this,i),o=o||i;if(!e&&o)return this.m(),this.i(),!0},u.U=function(){return this.f.length},u.getMap=e("c"),u.setMap=t("c"),u.w=e("g"),u.aa=t("g"),u.v=function(t){var e=this.getProjection(),i=new google.maps.LatLng(t.getNorthEast().lat(),t.getNorthEast().lng()),o=new google.maps.LatLng(t.getSouthWest().lat(),t.getSouthWest().lng());return(i=e.fromLatLngToDivPixel(i)).x+=this.g,i.y-=this.g,o=e.fromLatLngToDivPixel(o),o.x-=this.g,o.y+=this.g,i=e.fromDivPixelToLatLng(i),e=e.fromDivPixelToLatLng(o),t.extend(i),t.extend(e),t},u.R=function(){this.m(!0),this.a=[]},u.m=function(t){for(var e,i=0;e=this.f[i];i++)e.remove();for(i=0;e=this.a[i];i++)e.s=!1,t&&e.setMap(d);this.f=[]},u.L=function(){var t=this.f.slice();this.f.length=0,this.m(),this.i(),window.setTimeout(function(){for(var e,i=0;e=t[i];i++)e.remove()},0)},u.i=function(){s(this)},(u=r.prototype).q=function(t){var e;t:if(this.a.indexOf)e=-1!=this.a.indexOf(t);else{e=0;for(var i;i=this.a[e];e++)if(i==t){e=!0;break t}e=!1}if(e)return!1;if(this.d?this.r&&(i=this.a.length+1,e=(this.d.lat()*(i-1)+t.getPosition().lat())/i,i=(this.d.lng()*(i-1)+t.getPosition().lng())/i,this.d=new google.maps.LatLng(e,i),a(this)):(this.d=t.getPosition(),a(this)),t.s=!0,this.a.push(t),(e=this.a.length)<this.l&&t.getMap()!=this.c&&t.setMap(this.c),e==this.l)for(i=0;i<e;i++)this.a[i].setMap(d);if(e>=this.l&&t.setMap(d),t=this.c.getZoom(),(e=this.k.I())&&t>e)for(t=0;e=this.a[t];t++)e.setMap(this.c);else this.a.length<this.l?h(this.n):(e=this.k.H()(this.a,this.k.z().length),this.n.setCenter(this.d),(t=this.n).B=e,t.ga=e.text,t.ea=e.index,t.b&&(t.b.innerHTML=e.text),e=Math.max(0,t.B.index-1),e=Math.min(t.j.length-1,e),e=t.j[e],t.da=e.url,t.h=e.height,t.p=e.width,t.M=e.textColor,t.e=e.anchor,t.N=e.textSize,t.D=e.backgroundPosition,this.n.show());return!0},u.getBounds=function(){for(var t,e=new google.maps.LatLngBounds(this.d,this.d),i=this.o(),o=0;t=i[o];o++)e.extend(t.getPosition());return e},u.remove=function(){this.n.remove(),this.a.length=0,delete this.a},u.T=function(){return this.a.length},u.o=e("a"),u.getCenter=e("d"),u.getMap=e("c"),(u=l.prototype).onAdd=function(){this.b=document.createElement("DIV"),this.t&&(this.b.style.cssText=p(this,c(this,this.d)),this.b.innerHTML=this.B.text),this.getPanes().overlayMouseTarget.appendChild(this.b);var t=this;google.maps.event.addDomListener(this.b,"click",function(){var e=t.u.k;google.maps.event.trigger(e,"clusterclick",t.u),e.O&&t.c.fitBounds(t.u.getBounds())})},u.draw=function(){if(this.t){var t=c(this,this.d);this.b.style.top=t.y+"px",this.b.style.left=t.x+"px"}},u.show=function(){this.b&&(this.b.style.cssText=p(this,c(this,this.d)),this.b.style.display=""),this.t=!0},u.remove=function(){this.setMap(d)},u.onRemove=function(){this.b&&this.b.parentNode&&(h(this),this.b.parentNode.removeChild(this.b),this.b=d)},u.setCenter=t("d"),window.MarkerClusterer=i,i.prototype.addMarker=i.prototype.q,i.prototype.addMarkers=i.prototype.C,i.prototype.clearMarkers=i.prototype.R,i.prototype.fitMapToMarkers=i.prototype.S,i.prototype.getCalculator=i.prototype.H,i.prototype.getGridSize=i.prototype.w,i.prototype.getExtendedBounds=i.prototype.v,i.prototype.getMap=i.prototype.getMap,i.prototype.getMarkers=i.prototype.o,i.prototype.getMaxZoom=i.prototype.I,i.prototype.getStyles=i.prototype.z,i.prototype.getTotalClusters=i.prototype.U,i.prototype.getTotalMarkers=i.prototype.V,i.prototype.redraw=i.prototype.i,i.prototype.removeMarker=i.prototype.Y,i.prototype.removeMarkers=i.prototype.Z,i.prototype.resetViewport=i.prototype.m,i.prototype.repaint=i.prototype.L,i.prototype.setCalculator=i.prototype.$,i.prototype.setGridSize=i.prototype.aa,i.prototype.setMaxZoom=i.prototype.ba,i.prototype.onAdd=i.prototype.onAdd,i.prototype.draw=i.prototype.draw,r.prototype.getCenter=r.prototype.getCenter,r.prototype.getSize=r.prototype.T,r.prototype.getMarkers=r.prototype.o,l.prototype.onAdd=l.prototype.onAdd,l.prototype.draw=l.prototype.draw,l.prototype.onRemove=l.prototype.onRemove}(),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";function e(t){var e=t.parent();t.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeClass("minicolors-input"),e.before(t).remove()}function i(t){var e=t.parent(),i=e.find(".minicolors-panel"),n=t.data("minicolors-settings");!t.data("minicolors-initialized")||t.prop("disabled")||e.hasClass("minicolors-inline")||e.hasClass("minicolors-focus")||(o(),e.addClass("minicolors-focus"),i.stop(!0,!0).fadeIn(n.showSpeed,function(){n.show&&n.show.call(t.get(0))}))}function o(){t(".minicolors-focus").each(function(){var e=t(this),i=e.find(".minicolors-input"),o=e.find(".minicolors-panel"),n=i.data("minicolors-settings");o.fadeOut(n.hideSpeed,function(){n.hide&&n.hide.call(i.get(0)),e.removeClass("minicolors-focus")})})}function n(t,e,i){var o,n,r,a,l=t.parents(".minicolors").find(".minicolors-input"),c=l.data("minicolors-settings"),h=t.find("[class$=-picker]"),p=t.offset().left,u=t.offset().top,d=Math.round(e.pageX-p),f=Math.round(e.pageY-u),g=i?c.animationSpeed:0;e.originalEvent.changedTouches&&(d=e.originalEvent.changedTouches[0].pageX-p,f=e.originalEvent.changedTouches[0].pageY-u),0>d&&(d=0),0>f&&(f=0),d>t.width()&&(d=t.width()),f>t.height()&&(f=t.height()),t.parent().is(".minicolors-slider-wheel")&&h.parent().is(".minicolors-grid")&&(o=75-d,n=75-f,r=Math.sqrt(o*o+n*n),0>(a=Math.atan2(n,o))&&(a+=2*Math.PI),r>75&&(r=75,d=75-75*Math.cos(a),f=75-75*Math.sin(a)),d=Math.round(d),f=Math.round(f)),t.is(".minicolors-grid")?h.stop(!0).animate({top:f+"px",left:d+"px"},g,c.animationEasing,function(){s(l,t)}):h.stop(!0).animate({top:f+"px"},g,c.animationEasing,function(){s(l,t)})}function s(t,e){function i(t,e){var i,o;return t.length&&e?(i=t.offset().left,o=t.offset().top,{x:i-e.offset().left+t.outerWidth()/2,y:o-e.offset().top+t.outerHeight()/2}):null}var o,n,s,r,c,h,p,d,f=t.val(),v=t.attr("data-opacity"),y=t.parent(),_=t.data("minicolors-settings"),b=y.find(".minicolors-swatch"),B=y.find(".minicolors-grid"),w=y.find(".minicolors-slider"),k=y.find(".minicolors-opacity-slider"),x=B.find("[class$=-picker]"),C=w.find("[class$=-picker]"),O=k.find("[class$=-picker]"),S=i(x,B),$=i(C,w),A=i(O,k);if(e.is(".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider")){switch(_.control){case"wheel":r=B.width()/2-S.x,c=B.height()/2-S.y,h=Math.sqrt(r*r+c*c),0>(p=Math.atan2(c,r))&&(p+=2*Math.PI),h>75&&(h=75,S.x=69-75*Math.cos(p),S.y=69-75*Math.sin(p)),n=u(h/.75,0,100),f=g({h:o=u(180*p/Math.PI,0,360),s:n,b:s=u(100-Math.floor($.y*(100/w.height())),0,100)}),w.css("backgroundColor",g({h:o,s:n,b:100}));break;case"saturation":f=g({h:o=u(parseInt(S.x*(360/B.width()),10),0,360),s:n=u(100-Math.floor($.y*(100/w.height())),0,100),b:s=u(100-Math.floor(S.y*(100/B.height())),0,100)}),w.css("backgroundColor",g({h:o,s:100,b:s})),y.find(".minicolors-grid-inner").css("opacity",n/100);break;case"brightness":f=g({h:o=u(parseInt(S.x*(360/B.width()),10),0,360),s:n=u(100-Math.floor(S.y*(100/B.height())),0,100),b:s=u(100-Math.floor($.y*(100/w.height())),0,100)}),w.css("backgroundColor",g({h:o,s:n,b:100})),y.find(".minicolors-grid-inner").css("opacity",1-s/100);break;default:f=g({h:o=u(360-parseInt($.y*(360/w.height()),10),0,360),s:n=u(Math.floor(S.x*(100/B.width())),0,100),b:s=u(100-Math.floor(S.y*(100/B.height())),0,100)}),B.css("backgroundColor",g({h:o,s:100,b:100}))}if(v=_.opacity?parseFloat(1-A.y/k.height()).toFixed(2):1,_.opacity&&t.attr("data-opacity",v),"rgb"===_.format){var M=m(f),v=""===t.attr("data-opacity")?1:u(parseFloat(t.attr("data-opacity")).toFixed(2),0,1);(isNaN(v)||!_.opacity)&&(v=1),d=t.minicolors("rgbObject").a<=1&&M&&_.opacity?"rgba("+M.r+", "+M.g+", "+M.b+", "+parseFloat(v)+")":"rgb("+M.r+", "+M.g+", "+M.b+")"}else d=l(f,_.letterCase);t.val(d)}b.find("span").css({backgroundColor:f,opacity:v}),a(t,d,v)}function r(e,i){var o,n,s,r,f,v,y,_,b,B,w=e.parent(),k=e.data("minicolors-settings"),x=w.find(".minicolors-swatch"),C=w.find(".minicolors-grid"),O=w.find(".minicolors-slider"),S=w.find(".minicolors-opacity-slider"),$=C.find("[class$=-picker]"),A=O.find("[class$=-picker]"),M=S.find("[class$=-picker]");switch(d(e.val())?(o=function(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):""}(e.val()),(f=u(parseFloat(function(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d{1,2})?|\.\d{1,2})[\s+]?/i))&&6===t.length?t[4]:"1"}(e.val())).toFixed(2),0,1))&&e.attr("data-opacity",f)):o=l(c(e.val(),!0),k.letterCase),o||(o=l(p(k.defaultValue,!0),k.letterCase)),n=function(t){var e=function(t){var e={h:0,s:0,b:0},i=Math.min(t.r,t.g,t.b),o=Math.max(t.r,t.g,t.b),n=o-i;return e.b=o,e.s=0!==o?255*n/o:0,0!==e.s?t.r===o?e.h=(t.g-t.b)/n:t.g===o?e.h=2+(t.b-t.r)/n:e.h=4+(t.r-t.g)/n:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255,e}(m(t));return 0===e.s&&(e.h=360),e}(o),r=k.keywords?t.map(k.keywords.split(","),function(e){return t.trim(e.toLowerCase())}):[],v=""!==e.val()&&t.inArray(e.val().toLowerCase(),r)>-1?l(e.val()):d(e.val())?h(e.val()):o,i||e.val(v),k.opacity&&(s=""===e.attr("data-opacity")?1:u(parseFloat(e.attr("data-opacity")).toFixed(2),0,1),isNaN(s)&&(s=1),e.attr("data-opacity",s),x.find("span").css("opacity",s),_=u(S.height()-S.height()*s,0,S.height()),M.css("top",_+"px")),"transparent"===e.val().toLowerCase()&&x.find("span").css("opacity",0),x.find("span").css("backgroundColor",o),k.control){case"wheel":b=u(Math.ceil(.75*n.s),0,C.height()/2),B=n.h*Math.PI/180,y=u(75-Math.cos(B)*b,0,C.width()),_=u(75-Math.sin(B)*b,0,C.height()),$.css({top:_+"px",left:y+"px"}),_=150-n.b/(100/C.height()),""===o&&(_=0),A.css("top",_+"px"),O.css("backgroundColor",g({h:n.h,s:n.s,b:100}));break;case"saturation":y=u(5*n.h/12,0,150),_=u(C.height()-Math.ceil(n.b/(100/C.height())),0,C.height()),$.css({top:_+"px",left:y+"px"}),_=u(O.height()-n.s*(O.height()/100),0,O.height()),A.css("top",_+"px"),O.css("backgroundColor",g({h:n.h,s:100,b:n.b})),w.find(".minicolors-grid-inner").css("opacity",n.s/100);break;case"brightness":y=u(5*n.h/12,0,150),_=u(C.height()-Math.ceil(n.s/(100/C.height())),0,C.height()),$.css({top:_+"px",left:y+"px"}),_=u(O.height()-n.b*(O.height()/100),0,O.height()),A.css("top",_+"px"),O.css("backgroundColor",g({h:n.h,s:n.s,b:100})),w.find(".minicolors-grid-inner").css("opacity",1-n.b/100);break;default:y=u(Math.ceil(n.s/(100/C.width())),0,C.width()),_=u(C.height()-Math.ceil(n.b/(100/C.height())),0,C.height()),$.css({top:_+"px",left:y+"px"}),_=u(O.height()-n.h/(360/O.height()),0,O.height()),A.css("top",_+"px"),C.css("backgroundColor",g({h:n.h,s:100,b:100}))}e.data("minicolors-initialized")&&a(e,v,s)}function a(t,e,i){var o=t.data("minicolors-settings"),n=t.data("minicolors-lastChange");n&&n.value===e&&n.opacity===i||(t.data("minicolors-lastChange",{value:e,opacity:i}),o.change&&(o.changeDelay?(clearTimeout(t.data("minicolors-changeTimeout")),t.data("minicolors-changeTimeout",setTimeout(function(){o.change.call(t.get(0),e,i)},o.changeDelay))):o.change.call(t.get(0),e,i)),t.trigger("change").trigger("input"))}function l(t,e){return"uppercase"===e?t.toUpperCase():t.toLowerCase()}function c(t,e){return(t=t.replace(/^#/g,"")).match(/^[A-F0-9]{3,6}/gi)?3!==t.length&&6!==t.length?"":(3===t.length&&e&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),"#"+t):""}function h(t,e){var i=t.replace(/[^\d,.]/g,"").split(",");return i[0]=u(parseInt(i[0],10),0,255),i[1]=u(parseInt(i[1],10),0,255),i[2]=u(parseInt(i[2],10),0,255),i[3]&&(i[3]=u(parseFloat(i[3],10),0,1)),e?{r:i[0],g:i[1],b:i[2],a:i[3]?i[3]:null}:void 0!==i[3]&&i[3]<=1?"rgba("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")":"rgb("+i[0]+", "+i[1]+", "+i[2]+")"}function p(t,e){return d(t)?h(t):c(t,e)}function u(t,e,i){return e>t&&(t=e),t>i&&(t=i),t}function d(t){var e=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return!(!e||4!==e.length)}function f(e){var i=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return t.each(i,function(t,e){1===e.length&&(i[t]="0"+e)}),"#"+i.join("")}function g(t){return f(function(t){var e={},i=Math.round(t.h),o=Math.round(255*t.s/100),n=Math.round(255*t.b/100);if(0===o)e.r=e.g=e.b=n;else{var s=n,r=(255-o)*n/255,a=i%60*(s-r)/60;360===i&&(i=0),60>i?(e.r=s,e.b=r,e.g=r+a):120>i?(e.g=s,e.b=r,e.r=s-a):180>i?(e.g=s,e.r=r,e.b=r+a):240>i?(e.b=s,e.r=r,e.g=s-a):300>i?(e.b=s,e.g=r,e.r=r+a):360>i?(e.r=s,e.g=r,e.b=s-a):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}}(t))}function m(t){return t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16),{r:t>>16,g:(65280&t)>>8,b:255&t}}t.minicolors={defaults:{animationSpeed:50,animationEasing:"swing",change:null,changeDelay:0,control:"hue",dataUris:!0,defaultValue:"",format:"hex",hide:null,hideSpeed:100,inline:!1,keywords:"",letterCase:"lowercase",opacity:!1,position:"bottom left",show:null,showSpeed:100,theme:"default"}},t.extend(t.fn,{minicolors:function(n,s){switch(n){case"destroy":return t(this).each(function(){e(t(this))}),t(this);case"hide":return o(),t(this);case"opacity":return void 0===s?t(this).attr("data-opacity"):(t(this).each(function(){r(t(this).attr("data-opacity",s))}),t(this));case"rgbObject":return function(e){var i=m(c(t(e).val(),!0)),o=t(e).attr("data-opacity");return i?(void 0!==o&&t.extend(i,{a:parseFloat(o)}),i):null}(t(this));case"rgbString":case"rgbaString":return function(e,i){var o=m(c(t(e).val(),!0)),n=t(e).attr("data-opacity");return o?(void 0===n&&(n=1),i?"rgba("+o.r+", "+o.g+", "+o.b+", "+parseFloat(n)+")":"rgb("+o.r+", "+o.g+", "+o.b+")"):null}(t(this),"rgbaString"===n);case"settings":return void 0===s?t(this).data("minicolors-settings"):(t(this).each(function(){var i=t(this).data("minicolors-settings")||{};e(t(this)),t(this).minicolors(t.extend(!0,i,s))}),t(this));case"show":return i(t(this).eq(0)),t(this);case"value":return void 0===s?t(this).val():(t(this).each(function(){"object"==typeof s?(s.opacity&&t(this).attr("data-opacity",u(s.opacity,0,1)),s.color&&t(this).val(s.color)):t(this).val(s),r(t(this))}),t(this));default:return"create"!==n&&(s=n),t(this).each(function(){!function(e,i){var o,n=t('<div class="minicolors" />'),s=t.minicolors.defaults;e.attr("data-opacity"),e.data("minicolors-initialized")||(i=t.extend(!0,{},s,i),n.addClass("minicolors-theme-"+i.theme).toggleClass("minicolors-with-opacity",i.opacity).toggleClass("minicolors-no-data-uris",!0!==i.dataUris),void 0!==i.position&&t.each(i.position.split(" "),function(){n.addClass("minicolors-position-"+this)}),o="rgb"===i.format?i.opacity?"25":"20":i.keywords?"11":"7",e.addClass("minicolors-input").data("minicolors-initialized",!1).data("minicolors-settings",i).prop("size",o).wrap(n).after('<div class="minicolors-panel minicolors-slider-'+i.control+'"><div class="minicolors-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-opacity-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-grid minicolors-sprite"><div class="minicolors-grid-inner"></div><div class="minicolors-picker"><div></div></div></div></div>'),i.inline||(e.after('<span class="minicolors-swatch minicolors-sprite"><span class="minicolors-swatch-color"></span></span>'),e.next(".minicolors-swatch").on("click",function(t){t.preventDefault(),e.focus()})),e.parent().find(".minicolors-panel").on("selectstart",function(){return!1}).end(),i.inline&&e.parent().addClass("minicolors-inline"),r(e,!1),e.data("minicolors-initialized",!0))}(t(this),s)}),t(this)}}}),t(document).on("mousedown.minicolors touchstart.minicolors",function(e){t(e.target).parents().add(e.target).hasClass("minicolors")||o()}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(e){var i=t(this);e.preventDefault(),t(document).data("minicolors-target",i),n(i,e,!0)}).on("mousemove.minicolors touchmove.minicolors",function(e){var i=t(document).data("minicolors-target");i&&n(i,e)}).on("mouseup.minicolors touchend.minicolors",function(){t(this).removeData("minicolors-target")}).on("mousedown.minicolors touchstart.minicolors",".minicolors-swatch",function(e){var o=t(this).parent().find(".minicolors-input");e.preventDefault(),i(o)}).on("focus.minicolors",".minicolors-input",function(){var e=t(this);e.data("minicolors-initialized")&&i(e)}).on("blur.minicolors",".minicolors-input",function(){var e,i,o,n,s,r=t(this),a=r.data("minicolors-settings");r.data("minicolors-initialized")&&(e=a.keywords?t.map(a.keywords.split(","),function(e){return t.trim(e.toLowerCase())}):[],""!==r.val()&&t.inArray(r.val().toLowerCase(),e)>-1?s=r.val():(d(r.val())?o=h(r.val(),!0):(i=c(r.val(),!0),o=i?m(i):null),s=null===o?a.defaultValue:"rgb"===a.format?h(a.opacity?"rgba("+o.r+","+o.g+","+o.b+","+r.attr("data-opacity")+")":"rgb("+o.r+","+o.g+","+o.b+")"):f(o)),n=a.opacity?r.attr("data-opacity"):1,"transparent"===s.toLowerCase()&&(n=0),r.closest(".minicolors").find(".minicolors-swatch > span").css("opacity",n),r.val(s),""===r.val()&&r.val(p(a.defaultValue,!0)),r.val(l(r.val(),a.letterCase)))}).on("keydown.minicolors",".minicolors-input",function(e){var i=t(this);if(i.data("minicolors-initialized"))switch(e.keyCode){case 9:o();break;case 13:case 27:o(),i.blur()}}).on("keyup.minicolors",".minicolors-input",function(){var e=t(this);e.data("minicolors-initialized")&&r(e,!0)}).on("paste.minicolors",".minicolors-input",function(){var e=t(this);e.data("minicolors-initialized")&&setTimeout(function(){r(e,!0)},1)})}),"undefined"==typeof jQuery)throw new Error("multiselect requires jQuery");!function(t){"use strict";var e=jQuery.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<7)throw new Error("multiselect requires jQuery version 1.7 or higher")}(),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){"use strict";var e=function(t){function e(e,i){var o=e.prop("id");this.$left=e,this.$right=t(t(i.right).length?i.right:"#"+o+"_to"),this.actions={$leftAll:t(t(i.leftAll).length?i.leftAll:"#"+o+"_leftAll"),$rightAll:t(t(i.rightAll).length?i.rightAll:"#"+o+"_rightAll"),$leftSelected:t(t(i.leftSelected).length?i.leftSelected:"#"+o+"_leftSelected"),$rightSelected:t(t(i.rightSelected).length?i.rightSelected:"#"+o+"_rightSelected"),$undo:t(t(i.undo).length?i.undo:"#"+o+"_undo"),$redo:t(t(i.redo).length?i.redo:"#"+o+"_redo"),$moveUp:t(t(i.moveUp).length?i.moveUp:"#"+o+"_move_up"),$moveDown:t(t(i.moveDown).length?i.moveDown:"#"+o+"_move_down")},delete i.leftAll,delete i.leftSelected,delete i.right,delete i.rightAll,delete i.rightSelected,delete i.undo,delete i.redo,delete i.moveUp,delete i.moveDown,this.options={keepRenderingSort:i.keepRenderingSort,submitAllLeft:void 0===i.submitAllLeft||i.submitAllLeft,submitAllRight:void 0===i.submitAllRight||i.submitAllRight,search:i.search,ignoreDisabled:void 0!==i.ignoreDisabled&&i.ignoreDisabled,matchOptgroupBy:void 0!==i.matchOptgroupBy?i.matchOptgroupBy:"label"},delete i.keepRenderingSort,i.submitAllLeft,i.submitAllRight,i.search,i.ignoreDisabled,i.matchOptgroupBy,this.callbacks=i,this.init()}return e.prototype={init:function(){var e=this;e.undoStack=[],e.redoStack=[],e.options.keepRenderingSort&&(e.skipInitSort=!0,!1!==e.callbacks.sort&&(e.callbacks.sort=function(e,i){return t(e).data("position")>t(i).data("position")?1:-1}),e.$left.attachIndex(),e.$right.each(function(e,i){t(i).attachIndex()})),"function"==typeof e.callbacks.startUp&&e.callbacks.startUp(e.$left,e.$right),e.skipInitSort||"function"!=typeof e.callbacks.sort||(e.$left.mSort(e.callbacks.sort),e.$right.each(function(i,o){t(o).mSort(e.callbacks.sort)})),e.options.search&&e.options.search.left&&(e.options.search.$left=t(e.options.search.left),e.$left.before(e.options.search.$left)),e.options.search&&e.options.search.right&&(e.options.search.$right=t(e.options.search.right),e.$right.before(t(e.options.search.$right))),e.events()},events:function(){var e=this;e.options.search&&e.options.search.$left&&e.options.search.$left.on("keyup",function(i){e.callbacks.fireSearch(this.value)?(e.$left.find('option:search("'+this.value+'")').mShow(),e.$left.find('option:not(:search("'+this.value+'"))').mHide(),e.$left.find("option.hidden").parent("optgroup").not(t(":visible").parent()).mHide(),e.$left.find("option:not(.hidden)").parent("optgroup").mShow()):e.$left.find("option, optgroup").mShow()}),e.options.search&&e.options.search.$right&&e.options.search.$right.on("keyup",function(i){e.callbacks.fireSearch(this.value)?(e.$right.find('option:search("'+this.value+'")').mShow(),e.$right.find('option:not(:search("'+this.value+'"))').mHide(),e.$right.find("option.hidden").parent("optgroup").not(t(":visible").parent()).mHide(),e.$right.find("option:not(.hidden)").parent("optgroup").mShow()):e.$right.find("option, optgroup").mShow()}),e.$right.closest("form").on("submit",function(t){e.options.search&&(e.options.search.$left&&e.options.search.$left.val("").trigger("keyup"),e.options.search.$right&&e.options.search.$right.val("").trigger("keyup")),e.$left.find("option").prop("selected",e.options.submitAllLeft),e.$right.find("option").prop("selected",e.options.submitAllRight)}),e.$left.on("dblclick","option",function(t){t.preventDefault();var i=e.$left.find("option:selected");i.length&&e.moveToRight(i,t)}),e.$left.on("keypress",function(t){if(13===t.keyCode){t.preventDefault();var i=e.$left.find("option:selected");i.length&&e.moveToRight(i,t)}}),e.$right.on("dblclick","option",function(t){t.preventDefault();var i=e.$right.find("option:selected");i.length&&e.moveToLeft(i,t)}),e.$right.on("keydown",function(t){if(8===t.keyCode||46===t.keyCode){t.preventDefault();var i=e.$right.find("option:selected");i.length&&e.moveToLeft(i,t)}}),(navigator.userAgent.match(/MSIE/i)||navigator.userAgent.indexOf("Trident/")>0||navigator.userAgent.indexOf("Edge/")>0)&&(e.$left.dblclick(function(t){e.actions.$rightSelected.trigger("click")}),e.$right.dblclick(function(t){e.actions.$leftSelected.trigger("click")})),e.actions.$rightSelected.on("click",function(i){i.preventDefault();var o=e.$left.find("option:selected");o.length&&e.moveToRight(o,i),t(this).blur()}),e.actions.$leftSelected.on("click",function(i){i.preventDefault();var o=e.$right.find("option:selected");o.length&&e.moveToLeft(o,i),t(this).blur()}),e.actions.$rightAll.on("click",function(i){i.preventDefault();var o=e.$left.children(":not(span):not(.hidden)");o.length&&e.moveToRight(o,i),t(this).blur()}),e.actions.$leftAll.on("click",function(i){i.preventDefault();var o=e.$right.children(":not(span):not(.hidden)");o.length&&e.moveToLeft(o,i),t(this).blur()}),e.actions.$undo.on("click",function(t){t.preventDefault(),e.undo(t)}),e.actions.$redo.on("click",function(t){t.preventDefault(),e.redo(t)}),e.actions.$moveUp.on("click",function(i){i.preventDefault();var o=e.$right.find(":selected:not(span):not(.hidden)");o.length&&e.moveUp(o,i),t(this).blur()}),e.actions.$moveDown.on("click",function(i){i.preventDefault();var o=e.$right.find(":selected:not(span):not(.hidden)");o.length&&e.moveDown(o,i),t(this).blur()})},moveToRight:function(t,e,i,o){return"function"==typeof this.callbacks.moveToRight?this.callbacks.moveToRight(this,t,e,i,o):!("function"==typeof this.callbacks.beforeMoveToRight&&!i&&!this.callbacks.beforeMoveToRight(this.$left,this.$right,t))&&(this.moveFromAtoB(this.$left,this.$right,t,e,i,o),o||(this.undoStack.push(["right",t]),this.redoStack=[]),"function"!=typeof this.callbacks.sort||i||this.doNotSortRight||this.$right.mSort(this.callbacks.sort),"function"!=typeof this.callbacks.afterMoveToRight||i||this.callbacks.afterMoveToRight(this.$left,this.$right,t),this)},moveToLeft:function(t,e,i,o){return"function"==typeof this.callbacks.moveToLeft?this.callbacks.moveToLeft(this,t,e,i,o):!("function"==typeof this.callbacks.beforeMoveToLeft&&!i&&!this.callbacks.beforeMoveToLeft(this.$left,this.$right,t))&&(this.moveFromAtoB(this.$right,this.$left,t,e,i,o),o||(this.undoStack.push(["left",t]),this.redoStack=[]),"function"!=typeof this.callbacks.sort||i||this.$left.mSort(this.callbacks.sort),"function"!=typeof this.callbacks.afterMoveToLeft||i||this.callbacks.afterMoveToLeft(this.$left,this.$right,t),this)},moveFromAtoB:function(e,i,o,n,s,r){var a=this;return o.each(function(e,o){var n=t(o);if(a.options.ignoreDisabled&&n.is(":disabled"))return!0;if(n.is("optgroup")||n.parent().is("optgroup")){var s=n.is("optgroup")?n:n.parent(),r="optgroup["+a.options.matchOptgroupBy+'="'+s.prop(a.options.matchOptgroupBy)+'"]',l=i.find(r);l.length||((l=s.clone(!0)).empty(),i.move(l)),n.is("optgroup")?l.move(n.find("option")):l.move(n),s.removeIfEmpty()}else i.move(n)}),a},moveUp:function(t){if("function"==typeof this.callbacks.beforeMoveUp&&!this.callbacks.beforeMoveUp(t))return!1;t.first().prev().before(t),"function"==typeof this.callbacks.afterMoveUp&&this.callbacks.afterMoveUp(t)},moveDown:function(t){if("function"==typeof this.callbacks.beforeMoveDown&&!this.callbacks.beforeMoveDown(t))return!1;t.last().next().after(t),"function"==typeof this.callbacks.afterMoveDown&&this.callbacks.afterMoveDown(t)},undo:function(t){var e=this.undoStack.pop();if(e)switch(this.redoStack.push(e),e[0]){case"left":this.moveToRight(e[1],t,!1,!0);break;case"right":this.moveToLeft(e[1],t,!1,!0)}},redo:function(t){var e=this.redoStack.pop();if(e)switch(this.undoStack.push(e),e[0]){case"left":this.moveToLeft(e[1],t,!1,!0);break;case"right":this.moveToRight(e[1],t,!1,!0)}}},e}(t);t.multiselect={defaults:{startUp:function(e,i){i.find("option").each(function(i,o){if("OPTGROUP"==t(o).parent().prop("tagName")){var n='optgroup[label="'+t(o).parent().attr("label")+'"]';e.find(n+' option[value="'+o.value+'"]').each(function(t,e){e.remove()}),e.find(n).removeIfEmpty()}else e.find('option[value="'+o.value+'"]').remove()})},beforeMoveToRight:function(t,e,i){return!0},afterMoveToRight:function(t,e,i){},beforeMoveToLeft:function(t,e,i){return!0},afterMoveToLeft:function(t,e,i){},beforeMoveUp:function(t){return!0},afterMoveUp:function(t){},beforeMoveDown:function(t){return!0},afterMoveDown:function(t){},sort:function(t,e){return"NA"==t.innerHTML?1:"NA"==e.innerHTML?-1:t.innerHTML>e.innerHTML?1:-1},fireSearch:function(t){return t.length>1}}};var i=window.navigator.userAgent,o=i.indexOf("MSIE ")+i.indexOf("Trident/")+i.indexOf("Edge/")>-3,n=i.toLowerCase().indexOf("safari")>-1;t.fn.multiselect=function(i){return this.each(function(){var o=t(this),n=o.data("crlcu.multiselect"),s=t.extend({},t.multiselect.defaults,o.data(),"object"==typeof i&&i);n||o.data("crlcu.multiselect",n=new e(o,s))})},t.fn.move=function(t){return this.append(t).find("option").prop("selected",!1),this},t.fn.removeIfEmpty=function(){return this.children().length||this.remove(),this},t.fn.mShow=function(){return this.removeClass("hidden").show(),(o||n)&&this.each(function(e,i){t(i).parent().is("span")&&t(i).parent().replaceWith(i),t(i).show()}),this},t.fn.mHide=function(){return this.addClass("hidden").hide(),(o||n)&&this.each(function(e,i){t(i).parent().is("span")||t(i).wrap("<span>").hide()}),this},t.fn.mSort=function(e){return this.children().sort(e).appendTo(this),this.find("optgroup").each(function(i,o){t(o).children().sort(e).appendTo(o)}),this},t.fn.attachIndex=function(){this.children().each(function(e,i){var o=t(i);o.is("optgroup")&&o.children().each(function(e,i){t(i).data("position",e)}),o.data("position",e)})},t.expr[":"].search=function(e,i,o){var n=new RegExp(o[3],"i");return t(e).text().match(n)}}),function(t,e){"function"==typeof define&&define.amd?define("sifter",e):"object"==typeof exports?module.exports=e():t.Sifter=e()}(this,function(){var t=function(t,e){this.items=t,this.settings=e||{diacritics:!0}};t.prototype.tokenize=function(t){if(!(t=n(String(t||"").toLowerCase()))||!t.length)return[];var e,i,o,r,l=[],c=t.split(/ +/);for(e=0,i=c.length;e<i;e++){if(o=s(c[e]),this.settings.diacritics)for(r in a)a.hasOwnProperty(r)&&(o=o.replace(new RegExp(r,"g"),a[r]));l.push({string:c[e],regex:new RegExp(o,"i")})}return l},t.prototype.iterator=function(t,e){(r(t)?Array.prototype.forEach||function(t){for(var e=0,i=this.length;e<i;e++)t(this[e],e,this)}:function(t){for(var e in this)this.hasOwnProperty(e)&&t(this[e],e,this)}).apply(t,[e])},t.prototype.getScoreFunction=function(t,e){var i,n,s,r;t=this.prepareSearch(t,e),n=t.tokens,i=t.options.fields,s=n.length,r=t.options.nesting;var a=function(t,e){var i,o;return t?(t=String(t||""),-1===(o=t.search(e.regex))?0:(i=e.string.length/t.length,0===o&&(i+=.5),i)):0},l=function(){var t=i.length;return t?1===t?function(t,e){return a(o(e,i[0],r),t)}:function(e,n){for(var s=0,l=0;s<t;s++)l+=a(o(n,i[s],r),e);return l/t}:function(){return 0}}();return s?1===s?function(t){return l(n[0],t)}:"and"===t.options.conjunction?function(t){for(var e,i=0,o=0;i<s;i++){if((e=l(n[i],t))<=0)return 0;o+=e}return o/s}:function(t){for(var e=0,i=0;e<s;e++)i+=l(n[e],t);return i/s}:function(){return 0}},t.prototype.getSortFunction=function(t,i){var n,s,r,a,l,c,h,p,u,d,f;if(r=this,t=r.prepareSearch(t,i),f=!t.query&&i.sort_empty||i.sort,u=function(t,e){return"$score"===t?e.score:o(r.items[e.id],t,i.nesting)},l=[],f)for(n=0,s=f.length;n<s;n++)(t.query||"$score"!==f[n].field)&&l.push(f[n]);if(t.query){for(d=!0,n=0,s=l.length;n<s;n++)if("$score"===l[n].field){d=!1;break}d&&l.unshift({field:"$score",direction:"desc"})}else for(n=0,s=l.length;n<s;n++)if("$score"===l[n].field){l.splice(n,1);break}for(p=[],n=0,s=l.length;n<s;n++)p.push("desc"===l[n].direction?-1:1);return(c=l.length)?1===c?(a=l[0].field,h=p[0],function(t,i){return h*e(u(a,t),u(a,i))}):function(t,i){var o,n,s;for(o=0;o<c;o++)if(s=l[o].field,n=p[o]*e(u(s,t),u(s,i)))return n;return 0}:null},t.prototype.prepareSearch=function(t,e){if("object"==typeof t)return t;var o=(e=i({},e)).fields,n=e.sort,s=e.sort_empty;return o&&!r(o)&&(e.fields=[o]),n&&!r(n)&&(e.sort=[n]),s&&!r(s)&&(e.sort_empty=[s]),{options:e,query:String(t||"").toLowerCase(),tokens:this.tokenize(t),total:0,items:[]}},t.prototype.search=function(t,e){var i,o,n,s;return o=this.prepareSearch(t,e),e=o.options,t=o.query,s=e.score||this.getScoreFunction(o),t.length?this.iterator(this.items,function(t,n){i=s(t),(!1===e.filter||i>0)&&o.items.push({score:i,id:n})}):this.iterator(this.items,function(t,e){o.items.push({score:1,id:e})}),(n=this.getSortFunction(o,e))&&o.items.sort(n),o.total=o.items.length,"number"==typeof e.limit&&(o.items=o.items.slice(0,e.limit)),o};var e=function(t,e){return"number"==typeof t&&"number"==typeof e?t>e?1:t<e?-1:0:(t=l(String(t||"")),e=l(String(e||"")),t>e?1:e>t?-1:0)},i=function(t,e){var i,o,n,s;for(i=1,o=arguments.length;i<o;i++)if(s=arguments[i])for(n in s)s.hasOwnProperty(n)&&(t[n]=s[n]);return t},o=function(t,e,i){if(t&&e){if(!i)return t[e];for(var o=e.split(".");o.length&&(t=t[o.shift()]););return t}},n=function(t){return(t+"").replace(/^\s+|\s+$|/g,"")},s=function(t){return(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},r=Array.isArray||"undefined"!=typeof $&&$.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},a={a:"[a]",b:"[bB]",c:"[cCc]",d:"[dDd]",e:"[e]",f:"[f]",g:"[g]",h:"[h]",i:"[iiI]",j:"[j]",k:"[k]",l:"[l]",n:"[nNn]",o:"[o]",p:"[p]",q:"[qq]",r:"[r]",s:"[sSs]",t:"[t]",u:"[u]",v:"[v]",w:"[w]",x:"[x]",y:"[y]",z:"[z]"},l=function(){var t,e,i,o,n="",s={};for(i in a)if(a.hasOwnProperty(i))for(o=a[i].substring(2,a[i].length-1),n+=o,t=0,e=o.length;t<e;t++)s[o.charAt(t)]=i;var r=new RegExp("["+n+"]","g");return function(t){return t.replace(r,function(t){return s[t]}).toLowerCase()}}();return t}),function(t,e){"function"==typeof define&&define.amd?define("microplugin",e):"object"==typeof exports?module.exports=e():t.MicroPlugin=e()}(this,function(){var t={};t.mixin=function(t){t.plugins={},t.prototype.initializePlugins=function(t){var i,o,n,s=[];if(this.plugins={names:[],settings:{},requested:{},loaded:{}},e.isArray(t))for(i=0,o=t.length;i<o;i++)"string"==typeof t[i]?s.push(t[i]):(this.plugins.settings[t[i].name]=t[i].options,s.push(t[i].name));else if(t)for(n in t)t.hasOwnProperty(n)&&(this.plugins.settings[n]=t[n],s.push(n));for(;s.length;)this.require(s.shift())},t.prototype.loadPlugin=function(e){var i=this.plugins,o=t.plugins[e];if(!t.plugins.hasOwnProperty(e))throw new Error('Unable to find "'+e+'" plugin');i.requested[e]=!0,i.loaded[e]=o.fn.apply(this,[this.plugins.settings[e]||{}]),i.names.push(e)},t.prototype.require=function(t){var e=this.plugins;if(!this.plugins.loaded.hasOwnProperty(t)){if(e.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');this.loadPlugin(t)}return e.loaded[t]},t.define=function(e,i){t.plugins[e]={name:e,fn:i}}};var e={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}};return t}),function(t,e){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("sifter"),require("microplugin")):t.Selectize=e(t.jQuery,t.Sifter,t.MicroPlugin)}(this,function(t,e,i){"use strict";var o=function(t,e){if("string"!=typeof e||e.length){var i="string"==typeof e?new RegExp(e,"i"):e,o=function(t){var e=0;if(3===t.nodeType){var n=t.data.search(i);if(n>=0&&t.data.length>0){var s=t.data.match(i),r=document.createElement("span");r.className="highlight";var a=t.splitText(n),l=(a.splitText(s[0].length),a.cloneNode(!0));r.appendChild(l),a.parentNode.replaceChild(r,a),e=1}}else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName))for(var c=0;c<t.childNodes.length;++c)c+=o(t.childNodes[c]);return e};return t.each(function(){o(this)})}};t.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var t=this.parentNode;t.replaceChild(this.firstChild,this),t.normalize()}).end()};var n=function(){};n.prototype={on:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},off:function(t,e){var i=arguments.length;return 0===i?delete this._events:1===i?delete this._events[t]:(this._events=this._events||{},void(t in this._events!=0&&this._events[t].splice(this._events[t].indexOf(e),1)))},trigger:function(t){if(this._events=this._events||{},t in this._events!=0)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},n.mixin=function(t){for(var e=["on","off","trigger"],i=0;i<e.length;i++)t.prototype[e[i]]=n.prototype[e[i]]};var s=/Mac/.test(navigator.userAgent),r=s?91:17,a=s?18:17,l=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,c=function(t){return void 0!==t},h=function(t){return void 0===t||null===t?null:"boolean"==typeof t?t?"1":"0":t+""},p=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},u={};u.before=function(t,e,i){var o=t[e];t[e]=function(){return i.apply(t,arguments),o.apply(t,arguments)}},u.after=function(t,e,i){var o=t[e];t[e]=function(){var e=o.apply(t,arguments);return i.apply(t,arguments),e}};var d=function(t,e,i){var o,n=t.trigger,s={};t.trigger=function(){var i=arguments[0];return-1===e.indexOf(i)?n.apply(t,arguments):void(s[i]=arguments)},i.apply(t,[]),t.trigger=n;for(o in s)s.hasOwnProperty(o)&&n.apply(t,s[o])},f=function(t){var e={};if("selectionStart"in t)e.start=t.selectionStart,e.length=t.selectionEnd-e.start;else if(document.selection){t.focus();var i=document.selection.createRange(),o=document.selection.createRange().text.length;i.moveStart("character",-t.value.length),e.start=i.text.length-o,e.length=o}return e},g=function(e){var i=null,o=function(o,n){var s,r,a,l,c,h,p,u;o=o||window.event||{},n=n||{},o.metaKey||o.altKey||(n.force||!1!==e.data("grow"))&&(s=e.val(),o.type&&"keydown"===o.type.toLowerCase()&&(r=o.keyCode,a=r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||32===r,46===r||8===r?(u=f(e[0])).length?s=s.substring(0,u.start)+s.substring(u.start+u.length):8===r&&u.start?s=s.substring(0,u.start-1)+s.substring(u.start+1):46===r&&void 0!==u.start&&(s=s.substring(0,u.start)+s.substring(u.start+1)):a&&(h=o.shiftKey,p=String.fromCharCode(o.keyCode),p=h?p.toUpperCase():p.toLowerCase(),s+=p)),l=e.attr("placeholder"),!s&&l&&(s=l),(c=function(e,i){if(!e)return 0;var o=t("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(e).appendTo("body");!function(t,e,i){var o,n,s={};if(i)for(o=0,n=i.length;o<n;o++)s[i[o]]=t.css(i[o]);else s=t.css();e.css(s)}(i,o,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var n=o.width();return o.remove(),n}(s,e)+4)!==i&&(i=c,e.width(c),e.triggerHandler("resize")))};e.on("keydown keyup update blur",o),o()},m=function(t){var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML},v=function(i,o){var n,s,r,a;(a=i[0]).selectize=this;var l=window.getComputedStyle&&window.getComputedStyle(a,null);if(r=l?l.getPropertyValue("direction"):a.currentStyle&&a.currentStyle.direction,r=r||i.parents("[dir]:first").attr("dir")||"",t.extend(this,{order:0,settings:o,$input:i,tabIndex:i.attr("tabindex")||"",tagType:"select"===a.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(r),eventNS:".selectize"+ ++v.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:i.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===o.loadThrottle?this.onSearchChange:function(t,e){var i;return function(){var o=this,n=arguments;window.clearTimeout(i),i=window.setTimeout(function(){t.apply(o,n)},e)}}(this.onSearchChange,o.loadThrottle)}),this.sifter=new e(this.options,{diacritics:o.diacritics}),this.settings.options){for(n=0,s=this.settings.options.length;n<s;n++)this.registerOption(this.settings.options[n]);delete this.settings.options}if(this.settings.optgroups){for(n=0,s=this.settings.optgroups.length;n<s;n++)this.registerOptionGroup(this.settings.optgroups[n]);delete this.settings.optgroups}this.settings.mode=this.settings.mode||(1===this.settings.maxItems?"single":"multi"),"boolean"!=typeof this.settings.hideSelected&&(this.settings.hideSelected="multi"===this.settings.mode),this.initializePlugins(this.settings.plugins),this.setupCallbacks(),this.setupTemplates(),this.setup()};return n.mixin(v),void 0!==i?i.mixin(v):function(t,e){e||(e={});console.error("Selectize: "+t),e.explanation&&(console.group&&console.group(),console.error(e.explanation),console.group&&console.groupEnd())}("Dependency MicroPlugin is missing",{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),t.extend(v.prototype,{setup:function(){var e,i,o,n,c,h,p,u,d,f,m=this,v=m.settings,y=m.eventNS,_=t(window),b=t(document),B=m.$input;if(p=m.settings.mode,u=B.attr("class")||"",e=t("<div>").addClass(v.wrapperClass).addClass(u).addClass(p),i=t("<div>").addClass(v.inputClass).addClass("items").appendTo(e),o=t('<input type="text" autocomplete="off" />').appendTo(i).attr("tabindex",B.is(":disabled")?"-1":m.tabIndex),h=t(v.dropdownParent||e),n=t("<div>").addClass(v.dropdownClass).addClass(p).hide().appendTo(h),c=t("<div>").addClass(v.dropdownContentClass).appendTo(n),(f=B.attr("id"))&&(o.attr("id",f+"-selectized"),t("label[for='"+f+"']").attr("for",f+"-selectized")),m.settings.copyClassesToDropdown&&n.addClass(u),e.css({width:B[0].style.width}),m.plugins.names.length&&(d="plugin-"+m.plugins.names.join(" plugin-"),e.addClass(d),n.addClass(d)),(null===v.maxItems||v.maxItems>1)&&1===m.tagType&&B.attr("multiple","multiple"),m.settings.placeholder&&o.attr("placeholder",v.placeholder),!m.settings.splitOn&&m.settings.delimiter){var w=m.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");m.settings.splitOn=new RegExp("\\s*"+w+"+\\s*")}B.attr("autocorrect")&&o.attr("autocorrect",B.attr("autocorrect")),B.attr("autocapitalize")&&o.attr("autocapitalize",B.attr("autocapitalize")),m.$wrapper=e,m.$control=i,m.$control_input=o,m.$dropdown=n,m.$dropdown_content=c,n.on("mouseenter","[data-selectable]",function(){return m.onOptionHover.apply(m,arguments)}),n.on("mousedown click","[data-selectable]",function(){return m.onOptionSelect.apply(m,arguments)}),function(t,e,i,o){t.on(e,i,function(e){for(var i=e.target;i&&i.parentNode!==t[0];)i=i.parentNode;return e.currentTarget=i,o.apply(this,[e])})}(i,"mousedown","*:not(input)",function(){return m.onItemSelect.apply(m,arguments)}),g(o),i.on({mousedown:function(){return m.onMouseDown.apply(m,arguments)},click:function(){return m.onClick.apply(m,arguments)}}),o.on({mousedown:function(t){t.stopPropagation()},keydown:function(){return m.onKeyDown.apply(m,arguments)},keyup:function(){return m.onKeyUp.apply(m,arguments)},keypress:function(){return m.onKeyPress.apply(m,arguments)},resize:function(){m.positionDropdown.apply(m,[])},blur:function(){return m.onBlur.apply(m,arguments)},focus:function(){return m.ignoreBlur=!1,m.onFocus.apply(m,arguments)},paste:function(){return m.onPaste.apply(m,arguments)}}),b.on("keydown"+y,function(t){m.isCmdDown=t[s?"metaKey":"ctrlKey"],m.isCtrlDown=t[s?"altKey":"ctrlKey"],m.isShiftDown=t.shiftKey}),b.on("keyup"+y,function(t){t.keyCode===a&&(m.isCtrlDown=!1),16===t.keyCode&&(m.isShiftDown=!1),t.keyCode===r&&(m.isCmdDown=!1)}),b.on("mousedown"+y,function(t){if(m.isFocused){if(t.target===m.$dropdown[0]||t.target.parentNode===m.$dropdown[0])return!1;m.$control.has(t.target).length||t.target===m.$control[0]||m.blur(t.target)}}),_.on(["scroll"+y,"resize"+y].join(" "),function(){m.isOpen&&m.positionDropdown.apply(m,arguments)}),_.on("mousemove"+y,function(){m.ignoreHover=!1}),this.revertSettings={$children:B.children().detach(),tabindex:B.attr("tabindex")},B.attr("tabindex",-1).hide().after(m.$wrapper),t.isArray(v.items)&&(m.setValue(v.items),delete v.items),l&&B.on("invalid"+y,function(t){t.preventDefault(),m.isInvalid=!0,m.refreshState()}),m.updateOriginalInput(),m.refreshItems(),m.refreshState(),m.updatePlaceholder(),m.isSetup=!0,B.is(":disabled")&&m.disable(),m.on("change",this.onChange),B.data("selectize",m),B.addClass("selectized"),m.trigger("initialize"),!0===v.preload&&m.onSearchChange("")},setupTemplates:function(){var e=this.settings.labelField,i=this.settings.optgroupLabelField,o={optgroup:function(t){return'<div class="optgroup">'+t.html+"</div>"},optgroup_header:function(t,e){return'<div class="optgroup-header">'+e(t[i])+"</div>"},option:function(t,i){return'<div class="option">'+i(t[e])+"</div>"},item:function(t,i){return'<div class="item">'+i(t[e])+"</div>"},option_create:function(t,e){return'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>"}};this.settings.render=t.extend({},o,this.settings.render)},setupCallbacks:function(){var t,e,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in i)i.hasOwnProperty(t)&&(e=this.settings[i[t]])&&this.on(t,e)},onClick:function(t){this.isFocused||(this.focus(),t.preventDefault())},onMouseDown:function(e){var i=this,o=e.isDefaultPrevented();if(t(e.target),i.isFocused){if(e.target!==i.$control_input[0])return"single"===i.settings.mode?i.isOpen?i.close():i.open():o||i.setActiveItem(null),!1}else o||window.setTimeout(function(){i.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(e){var i=this;return i.isFull()||i.isInputHidden||i.isLocked?void e.preventDefault():void(i.settings.splitOn&&setTimeout(function(){var e=i.$control_input.val();if(e.match(i.settings.splitOn))for(var o=t.trim(e).split(i.settings.splitOn),n=0,s=o.length;n<s;n++)i.createItem(o[n])},0))},onKeyPress:function(t){if(this.isLocked)return t&&t.preventDefault();var e=String.fromCharCode(t.keyCode||t.which);return this.settings.create&&"multi"===this.settings.mode&&e===this.settings.delimiter?(this.createItem(),t.preventDefault(),!1):void 0},onKeyDown:function(t){var e=(t.target,this.$control_input[0],this);{if(!e.isLocked){switch(t.keyCode){case 65:if(e.isCmdDown)return void e.selectAll();break;case 27:return void(e.isOpen&&(t.preventDefault(),t.stopPropagation(),e.close()));case 78:if(!t.ctrlKey||t.altKey)break;case 40:if(!e.isOpen&&e.hasOptions)e.open();else if(e.$activeOption){e.ignoreHover=!0;var i=e.getAdjacentOption(e.$activeOption,1);i.length&&e.setActiveOption(i,!0,!0)}return void t.preventDefault();case 80:if(!t.ctrlKey||t.altKey)break;case 38:if(e.$activeOption){e.ignoreHover=!0;var o=e.getAdjacentOption(e.$activeOption,-1);o.length&&e.setActiveOption(o,!0,!0)}return void t.preventDefault();case 13:return void(e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),t.preventDefault()));case 37:return void e.advanceSelection(-1,t);case 39:return void e.advanceSelection(1,t);case 9:return e.settings.selectOnTab&&e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),e.isFull()||t.preventDefault()),void(e.settings.create&&e.createItem()&&t.preventDefault());case 8:case 46:return void e.deleteSelection(t)}return!e.isFull()&&!e.isInputHidden||(s?t.metaKey:t.ctrlKey)?void 0:void t.preventDefault()}9!==t.keyCode&&t.preventDefault()}},onKeyUp:function(t){if(this.isLocked)return t&&t.preventDefault();var e=this.$control_input.val()||"";this.lastValue!==e&&(this.lastValue=e,this.onSearchChange(e),this.refreshOptions(),this.trigger("type",e))},onSearchChange:function(t){var e=this,i=e.settings.load;i&&(e.loadedSearches.hasOwnProperty(t)||(e.loadedSearches[t]=!0,e.load(function(o){i.apply(e,[t,o])})))},onFocus:function(t){var e=this.isFocused;return this.isDisabled?(this.blur(),t&&t.preventDefault(),!1):void(this.ignoreFocus||(this.isFocused=!0,"focus"===this.settings.preload&&this.onSearchChange(""),e||this.trigger("focus"),this.$activeItems.length||(this.showInput(),this.setActiveItem(null),this.refreshOptions(!!this.settings.openOnFocus)),this.refreshState()))},onBlur:function(t,e){var i=this;if(i.isFocused&&(i.isFocused=!1,!i.ignoreFocus)){if(!i.ignoreBlur&&document.activeElement===i.$dropdown_content[0])return i.ignoreBlur=!0,void i.onFocus(t);var o=function(){i.close(),i.setTextboxValue(""),i.setActiveItem(null),i.setActiveOption(null),i.setCaret(i.items.length),i.refreshState(),e&&e.focus&&e.focus(),i.ignoreFocus=!1,i.trigger("blur")};i.ignoreFocus=!0,i.settings.create&&i.settings.createOnBlur?i.createItem(null,!1,o):o()}},onOptionHover:function(t){this.ignoreHover||this.setActiveOption(t.currentTarget,!1)},onOptionSelect:function(e){var i,o,n=this;e.preventDefault&&(e.preventDefault(),e.stopPropagation()),(o=t(e.currentTarget)).hasClass("create")?n.createItem(null,function(){n.settings.closeAfterSelect&&n.close()}):void 0!==(i=o.attr("data-value"))&&(n.lastQuery=null,n.setTextboxValue(""),n.addItem(i),n.settings.closeAfterSelect?n.close():!n.settings.hideSelected&&e.type&&/mouse/.test(e.type)&&n.setActiveOption(n.getOption(i)))},onItemSelect:function(t){this.isLocked||"multi"===this.settings.mode&&(t.preventDefault(),this.setActiveItem(t.currentTarget,t))},load:function(t){var e=this,i=e.$wrapper.addClass(e.settings.loadingClass);e.loading++,t.apply(e,[function(t){e.loading=Math.max(e.loading-1,0),t&&t.length&&(e.addOption(t),e.refreshOptions(e.isFocused&&!e.isInputHidden)),e.loading||i.removeClass(e.settings.loadingClass),e.trigger("load",t)}])},setTextboxValue:function(t){var e=this.$control_input;e.val()!==t&&(e.val(t).triggerHandler("update"),this.lastValue=t)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(t,e){d(this,e?[]:["change"],function(){this.clear(e),this.addItems(t,e)})},setActiveItem:function(e,i){var o,n,s,r,a,l,c,h;if("single"!==this.settings.mode){if(!(e=t(e)).length)return t(this.$activeItems).removeClass("active"),this.$activeItems=[],void(this.isFocused&&this.showInput());if("mousedown"===(o=i&&i.type.toLowerCase())&&this.isShiftDown&&this.$activeItems.length){for(h=this.$control.children(".active:last"),(r=Array.prototype.indexOf.apply(this.$control[0].childNodes,[h[0]]))>(a=Array.prototype.indexOf.apply(this.$control[0].childNodes,[e[0]]))&&(c=r,r=a,a=c),n=r;n<=a;n++)l=this.$control[0].childNodes[n],-1===this.$activeItems.indexOf(l)&&(t(l).addClass("active"),this.$activeItems.push(l));i.preventDefault()}else"mousedown"===o&&this.isCtrlDown||"keydown"===o&&this.isShiftDown?e.hasClass("active")?(s=this.$activeItems.indexOf(e[0]),this.$activeItems.splice(s,1),e.removeClass("active")):this.$activeItems.push(e.addClass("active")[0]):(t(this.$activeItems).removeClass("active"),this.$activeItems=[e.addClass("active")[0]]);this.hideInput(),this.isFocused||this.focus()}},setActiveOption:function(e,i,o){var n,s,r,a,l;this.$activeOption&&this.$activeOption.removeClass("active"),this.$activeOption=null,(e=t(e)).length&&(this.$activeOption=e.addClass("active"),!i&&c(i)||(n=this.$dropdown_content.height(),s=this.$activeOption.outerHeight(!0),i=this.$dropdown_content.scrollTop()||0,r=this.$activeOption.offset().top-this.$dropdown_content.offset().top+i,a=r,l=r-n+s,r+s>n+i?this.$dropdown_content.stop().animate({scrollTop:l},o?this.settings.scrollDuration:0):r<i&&this.$dropdown_content.stop().animate({scrollTop:a},o?this.settings.scrollDuration:0)))},selectAll:function(){"single"!==this.settings.mode&&(this.$activeItems=Array.prototype.slice.apply(this.$control.children(":not(input)").addClass("active")),this.$activeItems.length&&(this.hideInput(),this.close()),this.focus())},hideInput:function(){this.setTextboxValue(""),this.$control_input.css({opacity:0,position:"absolute",left:this.rtl?1e4:-1e4}),this.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var t=this;t.isDisabled||(t.ignoreFocus=!0,t.$control_input[0].focus(),window.setTimeout(function(){t.ignoreFocus=!1,t.onFocus()},0))},blur:function(t){this.$control_input[0].blur(),this.onBlur(null,t)},getScoreFunction:function(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())},getSearchOptions:function(){var t=this.settings,e=t.sortField;return"string"==typeof e&&(e=[{field:e}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e}},search:function(e){var i,o,n,s=this.settings,r=this.getSearchOptions();if(s.score&&"function"!=typeof(n=this.settings.score.apply(this,[e])))throw new Error('Selectize "score" setting must be a function that returns a function');if(e!==this.lastQuery?(this.lastQuery=e,o=this.sifter.search(e,t.extend(r,{score:n})),this.currentResults=o):o=t.extend(!0,{},this.currentResults),s.hideSelected)for(i=o.items.length-1;i>=0;i--)-1!==this.items.indexOf(h(o.items[i].id))&&o.items.splice(i,1);return o},refreshOptions:function(e){var i,n,s,r,a,l,c,p,u,d,f,g,v,y,_,b;void 0===e&&(e=!0);var B=this,w=t.trim(B.$control_input.val()),k=B.search(w),x=B.$dropdown_content,C=B.$activeOption&&h(B.$activeOption.attr("data-value"));for(r=k.items.length,"number"==typeof B.settings.maxOptions&&(r=Math.min(r,B.settings.maxOptions)),a={},l=[],i=0;i<r;i++)for(c=B.options[k.items[i].id],p=B.render("option",c),u=c[B.settings.optgroupField]||"",d=t.isArray(u)?u:[u],n=0,s=d&&d.length;n<s;n++)u=d[n],B.optgroups.hasOwnProperty(u)||(u=""),a.hasOwnProperty(u)||(a[u]=document.createDocumentFragment(),l.push(u)),a[u].appendChild(p);for(this.settings.lockOptgroupOrder&&l.sort(function(t,e){return(B.optgroups[t].$order||0)-(B.optgroups[e].$order||0)}),f=document.createDocumentFragment(),i=0,r=l.length;i<r;i++)u=l[i],B.optgroups.hasOwnProperty(u)&&a[u].childNodes.length?((g=document.createDocumentFragment()).appendChild(B.render("optgroup_header",B.optgroups[u])),g.appendChild(a[u]),f.appendChild(B.render("optgroup",t.extend({},B.optgroups[u],{html:m(g),dom:g})))):f.appendChild(a[u]);if(x.html(f),B.settings.highlight&&k.query.length&&k.tokens.length)for(x.removeHighlight(),i=0,r=k.tokens.length;i<r;i++)o(x,k.tokens[i].regex);if(!B.settings.hideSelected)for(i=0,r=B.items.length;i<r;i++)B.getOption(B.items[i]).addClass("selected");(v=B.canCreate(w))&&(x.prepend(B.render("option_create",{input:w})),b=t(x[0].childNodes[0])),B.hasOptions=k.items.length>0||v,B.hasOptions?(k.items.length>0?((_=C&&B.getOption(C))&&_.length?y=_:"single"===B.settings.mode&&B.items.length&&(y=B.getOption(B.items[0])),y&&y.length||(y=b&&!B.settings.addPrecedence?B.getAdjacentOption(b,1):x.find("[data-selectable]:first"))):y=b,B.setActiveOption(y),e&&!B.isOpen&&B.open()):(B.setActiveOption(null),e&&B.isOpen&&B.close())},addOption:function(e){var i,o,n;if(t.isArray(e))for(i=0,o=e.length;i<o;i++)this.addOption(e[i]);else(n=this.registerOption(e))&&(this.userOptions[n]=!0,this.lastQuery=null,this.trigger("option_add",n,e))},registerOption:function(t){var e=h(t[this.settings.valueField]);return void 0!==e&&null!==e&&!this.options.hasOwnProperty(e)&&(t.$order=t.$order||++this.order,this.options[e]=t,e)},registerOptionGroup:function(t){var e=h(t[this.settings.optgroupValueField]);return!!e&&(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)},addOptionGroup:function(t,e){e[this.settings.optgroupValueField]=t,(t=this.registerOptionGroup(e))&&this.trigger("optgroup_add",t,e)},removeOptionGroup:function(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.renderCache={},this.trigger("optgroup_remove",t))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(e,i){var o,n,s,r,a,l,c;if(e=h(e),s=h(i[this.settings.valueField]),null!==e&&this.options.hasOwnProperty(e)){if("string"!=typeof s)throw new Error("Value must be set in option data");c=this.options[e].$order,s!==e&&(delete this.options[e],-1!==(r=this.items.indexOf(e))&&this.items.splice(r,1,s)),i.$order=i.$order||c,this.options[s]=i,a=this.renderCache.item,l=this.renderCache.option,a&&(delete a[e],delete a[s]),l&&(delete l[e],delete l[s]),-1!==this.items.indexOf(s)&&(o=this.getItem(e),n=t(this.render("item",i)),o.hasClass("active")&&n.addClass("active"),o.replaceWith(n)),this.lastQuery=null,this.isOpen&&this.refreshOptions(!1)}},removeOption:function(t,e){t=h(t);var i=this.renderCache.item,o=this.renderCache.option;i&&delete i[t],o&&delete o[t],delete this.userOptions[t],delete this.options[t],this.lastQuery=null,this.trigger("option_remove",t),this.removeItem(t,e)},clearOptions:function(){this.loadedSearches={},this.userOptions={},this.renderCache={},this.options=this.sifter.items={},this.lastQuery=null,this.trigger("option_clear"),this.clear()},getOption:function(t){return this.getElementWithValue(t,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(e,i){var o=this.$dropdown.find("[data-selectable]"),n=o.index(e)+i;return n>=0&&n<o.length?o.eq(n):t()},getElementWithValue:function(e,i){if(void 0!==(e=h(e))&&null!==e)for(var o=0,n=i.length;o<n;o++)if(i[o].getAttribute("data-value")===e)return t(i[o]);return t()},getItem:function(t){return this.getElementWithValue(t,this.$control.children())},addItems:function(e,i){for(var o=t.isArray(e)?e:[e],n=0,s=o.length;n<s;n++)this.isPending=n<s-1,this.addItem(o[n],i)},addItem:function(e,i){d(this,i?[]:["change"],function(){var o,n,s,r,a,l=this.settings.mode;return e=h(e),-1!==this.items.indexOf(e)?void("single"===l&&this.close()):void(this.options.hasOwnProperty(e)&&("single"===l&&this.clear(i),"multi"===l&&this.isFull()||(o=t(this.render("item",this.options[e])),a=this.isFull(),this.items.splice(this.caretPos,0,e),this.insertAtCaret(o),(!this.isPending||!a&&this.isFull())&&this.refreshState(),this.isSetup&&(s=this.$dropdown_content.find("[data-selectable]"),this.isPending||(n=this.getOption(e),r=this.getAdjacentOption(n,1).attr("data-value"),this.refreshOptions(this.isFocused&&"single"!==l),r&&this.setActiveOption(this.getOption(r))),!s.length||this.isFull()?this.close():this.positionDropdown(),this.updatePlaceholder(),this.trigger("item_add",e,o),this.updateOriginalInput({silent:i})))))})},removeItem:function(e,i){var o,n,s;o=e instanceof t?e:this.getItem(e),e=h(o.attr("data-value")),-1!==(n=this.items.indexOf(e))&&(o.remove(),o.hasClass("active")&&(s=this.$activeItems.indexOf(o[0]),this.$activeItems.splice(s,1)),this.items.splice(n,1),this.lastQuery=null,!this.settings.persist&&this.userOptions.hasOwnProperty(e)&&this.removeOption(e,i),n<this.caretPos&&this.setCaret(this.caretPos-1),this.refreshState(),this.updatePlaceholder(),this.updateOriginalInput({silent:i}),this.positionDropdown(),this.trigger("item_remove",e,o))},createItem:function(e,i){var o=this,n=o.caretPos;e=e||t.trim(o.$control_input.val()||"");var s=arguments[arguments.length-1];if("function"!=typeof s&&(s=function(){}),"boolean"!=typeof i&&(i=!0),!o.canCreate(e))return s(),!1;o.lock();var r="function"==typeof o.settings.create?this.settings.create:function(t){var e={};return e[o.settings.labelField]=t,e[o.settings.valueField]=t,e},a=function(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}(function(t){if(o.unlock(),!t||"object"!=typeof t)return s();var e=h(t[o.settings.valueField]);return"string"!=typeof e?s():(o.setTextboxValue(""),o.addOption(t),o.setCaret(n),o.addItem(e),o.refreshOptions(i&&"single"!==o.settings.mode),void s(t))}),l=r.apply(this,[e,a]);return void 0!==l&&a(l),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var t=!this.items.length;this.isInvalid=t,this.$control_input.prop("required",t),this.$input.prop("required",!t)},refreshClasses:function(){var e=this.isFull(),i=this.isLocked;this.$wrapper.toggleClass("rtl",this.rtl),this.$control.toggleClass("focus",this.isFocused).toggleClass("disabled",this.isDisabled).toggleClass("required",this.isRequired).toggleClass("invalid",this.isInvalid).toggleClass("locked",i).toggleClass("full",e).toggleClass("not-full",!e).toggleClass("input-active",this.isFocused&&!this.isInputHidden).toggleClass("dropdown-active",this.isOpen).toggleClass("has-options",!t.isEmptyObject(this.options)).toggleClass("has-items",this.items.length>0),this.$control_input.data("grow",!e&&!i)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(t){var e,i,o,n;if(t=t||{},1===this.tagType){for(o=[],e=0,i=this.items.length;e<i;e++)n=this.options[this.items[e]][this.settings.labelField]||"",o.push('<option value="'+p(this.items[e])+'" selected="selected">'+p(n)+"</option>");o.length||this.$input.attr("multiple")||o.push('<option value="" selected="selected"></option>'),this.$input.html(o.join(""))}else this.$input.val(this.getValue()),this.$input.attr("value",this.$input.val());this.isSetup&&(t.silent||this.trigger("change",this.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var t=this.$control_input;this.items.length?t.removeAttr("placeholder"):t.attr("placeholder",this.settings.placeholder),t.triggerHandler("update",{force:!0})}},open:function(){this.isLocked||this.isOpen||"multi"===this.settings.mode&&this.isFull()||(this.focus(),this.isOpen=!0,this.refreshState(),this.$dropdown.css({visibility:"hidden",display:"block"}),this.positionDropdown(),this.$dropdown.css({visibility:"visible"}),this.trigger("dropdown_open",this.$dropdown))},close:function(){var t=this.isOpen;"single"===this.settings.mode&&this.items.length&&(this.hideInput(),this.$control_input.blur()),this.isOpen=!1,this.$dropdown.hide(),this.setActiveOption(null),this.refreshState(),t&&this.trigger("dropdown_close",this.$dropdown)},positionDropdown:function(){var t=this.$control,e="body"===this.settings.dropdownParent?t.offset():t.position();e.top+=t.outerHeight(!0),this.$dropdown.css({width:t.outerWidth(),top:e.top,left:e.left})},clear:function(t){this.items.length&&(this.$control.children(":not(input)").remove(),this.items=[],this.lastQuery=null,this.setCaret(0),this.setActiveItem(null),this.updatePlaceholder(),this.updateOriginalInput({silent:t}),this.refreshState(),this.showInput(),this.trigger("clear"))},insertAtCaret:function(e){var i=Math.min(this.caretPos,this.items.length);0===i?this.$control.prepend(e):t(this.$control[0].childNodes[i]).before(e),this.setCaret(i+1)},deleteSelection:function(e){var i,o,n,s,r,a,l,c,h;if(n=e&&8===e.keyCode?-1:1,s=f(this.$control_input[0]),this.$activeOption&&!this.settings.hideSelected&&(l=this.getAdjacentOption(this.$activeOption,-1).attr("data-value")),r=[],this.$activeItems.length){for(h=this.$control.children(".active:"+(n>0?"last":"first")),a=this.$control.children(":not(input)").index(h),n>0&&a++,i=0,o=this.$activeItems.length;i<o;i++)r.push(t(this.$activeItems[i]).attr("data-value"));e&&(e.preventDefault(),e.stopPropagation())}else(this.isFocused||"single"===this.settings.mode)&&this.items.length&&(n<0&&0===s.start&&0===s.length?r.push(this.items[this.caretPos-1]):n>0&&s.start===this.$control_input.val().length&&r.push(this.items[this.caretPos]));if(!r.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete.apply(this,[r]))return!1;for(void 0!==a&&this.setCaret(a);r.length;)this.removeItem(r.pop());return this.showInput(),this.positionDropdown(),this.refreshOptions(!0),l&&(c=this.getOption(l)).length&&this.setActiveOption(c),!0},advanceSelection:function(t,e){var i,o,n,s,r;0!==t&&(this.rtl&&(t*=-1),i=t>0?"last":"first",o=f(this.$control_input[0]),this.isFocused&&!this.isInputHidden?(s=this.$control_input.val().length,(t<0?0===o.start&&0===o.length:o.start===s)&&!s&&this.advanceCaret(t,e)):(r=this.$control.children(".active:"+i)).length&&(n=this.$control.children(":not(input)").index(r),this.setActiveItem(null),this.setCaret(t>0?n+1:n)))},advanceCaret:function(t,e){var i,o;0!==t&&(i=t>0?"next":"prev",this.isShiftDown?(o=this.$control_input[i]()).length&&(this.hideInput(),this.setActiveItem(o),e&&e.preventDefault()):this.setCaret(this.caretPos+t))},setCaret:function(e){if(e="single"===this.settings.mode?this.items.length:Math.max(0,Math.min(this.items.length,e)),!this.isPending){var i,o,n,s;for(i=0,o=(n=this.$control.children(":not(input)")).length;i<o;i++)s=t(n[i]).detach(),i<e?this.$control_input.before(s):this.$control.append(s)}this.caretPos=e},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){this.$input.prop("disabled",!0),this.$control_input.prop("disabled",!0).prop("tabindex",-1),this.isDisabled=!0,this.lock()},enable:function(){this.$input.prop("disabled",!1),this.$control_input.prop("disabled",!1).prop("tabindex",this.tabIndex),this.isDisabled=!1,this.unlock()},destroy:function(){var e=this.eventNS,i=this.revertSettings;this.trigger("destroy"),this.off(),this.$wrapper.remove(),this.$dropdown.remove(),this.$input.html("").append(i.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:i.tabindex}).show(),this.$control_input.removeData("grow"),this.$input.removeData("selectize"),t(window).off(e),t(document).off(e),t(document.body).off(e),delete this.$input[0].selectize},render:function(e,i){var o,n,s="",r=!1;return"option"!==e&&"item"!==e||(o=h(i[this.settings.valueField]),r=!!o),r&&(c(this.renderCache[e])||(this.renderCache[e]={}),this.renderCache[e].hasOwnProperty(o))?this.renderCache[e][o]:(s=t(this.settings.render[e].apply(this,[i,p])),"option"===e||"option_create"===e?s.attr("data-selectable",""):"optgroup"===e&&(n=i[this.settings.optgroupValueField]||"",s.attr("data-group",n)),"option"!==e&&"item"!==e||s.attr("data-value",o||""),r&&(this.renderCache[e][o]=s[0]),s[0])},clearCache:function(t){void 0===t?this.renderCache={}:delete this.renderCache[t]},canCreate:function(t){if(!this.settings.create)return!1;var e=this.settings.createFilter;return t.length&&("function"!=typeof e||e.apply(this,[t]))&&("string"!=typeof e||new RegExp(e).test(t))&&(!(e instanceof RegExp)||e.test(t))}}),v.count=0,v.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},t.fn.selectize=function(e){var i=t.fn.selectize.defaults,o=t.extend({},i,e),n=o.dataAttr,s=o.labelField,r=o.valueField,a=o.optgroupField,l=o.optgroupLabelField,c=o.optgroupValueField;return this.each(function(){if(!this.selectize){var p=t(this),u=this.tagName.toLowerCase(),d=p.attr("placeholder")||p.attr("data-placeholder");d||o.allowEmptyOption||(d=p.children('option[value=""]').text());var f={placeholder:d,options:[],optgroups:[],items:[]};"select"===u?function(e,i){var p,u,d,f,g=i.options,m={},v=function(t){var e=n&&t.attr(n);return"string"==typeof e&&e.length?JSON.parse(e):null},y=function(e,n){e=t(e);var l=h(e.val());if(l||o.allowEmptyOption)if(m.hasOwnProperty(l)){if(n){var c=m[l][a];c?t.isArray(c)?c.push(n):m[l][a]=[c,n]:m[l][a]=n}}else{var p=v(e)||{};p[s]=p[s]||e.text(),p[r]=p[r]||l,p[a]=p[a]||n,m[l]=p,g.push(p),e.is(":selected")&&i.items.push(l)}},_=function(e){var o,n,s,r,a;for((s=(e=t(e)).attr("label"))&&(r=v(e)||{},r[l]=s,r[c]=s,i.optgroups.push(r)),o=0,n=(a=t("option",e)).length;o<n;o++)y(a[o],s)};for(i.maxItems=e.attr("multiple")?null:1,p=0,u=(f=e.children()).length;p<u;p++)"optgroup"===(d=f[p].tagName.toLowerCase())?_(f[p]):"option"===d&&y(f[p])}(p,f):function(e,i){var a,l,c,h,p=e.attr(n);if(p)for(i.options=JSON.parse(p),a=0,l=i.options.length;a<l;a++)i.items.push(i.options[a][r]);else{var u=t.trim(e.val()||"");if(!o.allowEmptyOption&&!u.length)return;for(a=0,l=(c=u.split(o.delimiter)).length;a<l;a++)h={},h[s]=c[a],h[r]=c[a],i.options.push(h);i.items=c}}(p,f),new v(p,t.extend(!0,{},i,f,e))}})},t.fn.selectize.defaults=v.defaults,t.fn.selectize.support={validity:l},v.define("drag_drop",function(e){if(!t.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var i=this;i.lock=function(){var t=i.lock;return function(){var e=i.$control.data("sortable");return e&&e.disable(),t.apply(i,arguments)}}(),i.unlock=function(){var t=i.unlock;return function(){var e=i.$control.data("sortable");return e&&e.enable(),t.apply(i,arguments)}}(),i.setup=function(){var e=i.setup;return function(){e.apply(this,arguments);var o=i.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:i.isLocked,start:function(t,e){e.placeholder.css("width",e.helper.css("width")),o.css({overflow:"visible"})},stop:function(){o.css({overflow:"hidden"});var e=i.$activeItems?i.$activeItems.slice():null,n=[];o.children("[data-value]").each(function(){n.push(t(this).attr("data-value"))}),i.setValue(n),i.setActiveItem(e)}})}}()}}),v.define("dropdown_header",function(e){var i=this;e=t.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(t){return'<div class="'+t.headerClass+'"><div class="'+t.titleRowClass+'"><span class="'+t.labelClass+'">'+t.title+'</span><a href="javascript:void(0)" class="'+t.closeClass+'">&times;</a></div></div>'}},e),i.setup=function(){var o=i.setup;return function(){o.apply(i,arguments),i.$dropdown_header=t(e.html(e)),i.$dropdown.prepend(i.$dropdown_header)}}()}),v.define("optgroup_columns",function(e){var i=this;e=t.extend({equalizeWidth:!0,equalizeHeight:!0},e),this.getAdjacentOption=function(e,i){var o=e.closest("[data-group]").find("[data-selectable]"),n=o.index(e)+i;return n>=0&&n<o.length?o.eq(n):t()},this.onKeyDown=function(){var t=i.onKeyDown;return function(e){var o,n,s,r;return!this.isOpen||37!==e.keyCode&&39!==e.keyCode?t.apply(this,arguments):(i.ignoreHover=!0,r=this.$activeOption.closest("[data-group]"),o=r.find("[data-selectable]").index(this.$activeOption),r=37===e.keyCode?r.prev("[data-group]"):r.next("[data-group]"),s=r.find("[data-selectable]"),void((n=s.eq(Math.min(s.length-1,o))).length&&this.setActiveOption(n)))}}();var o=function(){var t,e=o.width,i=document;return void 0===e&&(t=i.createElement("div"),t.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',t=t.firstChild,i.body.appendChild(t),e=o.width=t.offsetWidth-t.clientWidth,i.body.removeChild(t)),e},n=function(){var n,s,r,a,l,c,h;if(h=t("[data-group]",i.$dropdown_content),(s=h.length)&&i.$dropdown_content.width()){if(e.equalizeHeight){for(r=0,n=0;n<s;n++)r=Math.max(r,h.eq(n).height());h.css({height:r})}e.equalizeWidth&&(c=i.$dropdown_content.innerWidth()-o(),a=Math.round(c/s),h.css({width:a}),s>1&&(l=c-a*(s-1),h.eq(s-1).css({width:l})))}};(e.equalizeHeight||e.equalizeWidth)&&(u.after(this,"positionDropdown",n),u.after(this,"refreshOptions",n))}),v.define("remove_button",function(e){e=t.extend({label:"&times;",title:"Remove",className:"remove",append:!0},e);return"single"===this.settings.mode?void function(e,i){i.className="remove-single";var o=e,n='<a href="javascript:void(0)" class="'+i.className+'" tabindex="-1" title="'+p(i.title)+'">'+i.label+"</a>";e.setup=function(){var s=o.setup;return function(){if(i.append){var r=t(o.$input.context).attr("id"),a=(t("#"+r),o.settings.render.item);o.settings.render.item=function(t){return function(t,e){return t+n}(a.apply(e,arguments))}}s.apply(e,arguments),e.$control.on("click","."+i.className,function(t){t.preventDefault(),o.isLocked||o.clear()})}}()}(this,e):void function(e,i){var o=e,n='<a href="javascript:void(0)" class="'+i.className+'" tabindex="-1" title="'+p(i.title)+'">'+i.label+"</a>";e.setup=function(){var s=o.setup;return function(){if(i.append){var r=o.settings.render.item;o.settings.render.item=function(t){return function(t,e){var i=t.search(/(<\/[^>]+>\s*)$/);return t.substring(0,i)+e+t.substring(i)}(r.apply(e,arguments),n)}}s.apply(e,arguments),e.$control.on("click","."+i.className,function(e){if(e.preventDefault(),!o.isLocked){var i=t(e.currentTarget).parent();o.setActiveItem(i),o.deleteSelection()&&o.setCaret(o.items.length)}})}}()}(this,e)}),v.define("restore_on_backspace",function(t){var e=this;t.text=t.text||function(t){return t[this.settings.labelField]},this.onKeyDown=function(){var i=e.onKeyDown;return function(e){var o,n;return 8===e.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(o=this.caretPos-1)>=0&&o<this.items.length?(n=this.options[this.items[o]],this.deleteSelection(e)&&(this.setTextboxValue(t.text.apply(this,[n])),this.refreshOptions(!0)),void e.preventDefault()):i.apply(this,arguments)}}()}),v}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Clipboard=t()}}(function(){return function t(e,i,o){function n(r,a){if(!i[r]){if(!e[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[r]={exports:{}};e[r][0].call(h.exports,function(t){return n(e[r][1][t]||t)},h,h.exports,t,e,i,o)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<o.length;r++)n(o[r]);return n}({1:[function(t,e,i){var o=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var n=Element.prototype;n.matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}e.exports=function(t,e){for(;t&&t.nodeType!==o;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},{}],2:[function(t,e,i){var o=t("./closest");e.exports=function(t,e,i,n,s){var r=function(t,e,i,n){return function(i){i.delegateTarget=o(i.target,e),i.delegateTarget&&n.call(t,i)}}.apply(this,arguments);return t.addEventListener(i,r,s),{destroy:function(){t.removeEventListener(i,r,s)}}}},{"./closest":1}],3:[function(t,e,i){i.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},i.nodeList=function(t){var e=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||i.node(t[0]))},i.string=function(t){return"string"==typeof t||t instanceof String},i.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},{}],4:[function(t,e,i){var o=t("./is"),n=t("delegate");e.exports=function(t,e,i){if(!t&&!e&&!i)throw new Error("Missing required arguments");if(!o.string(e))throw new TypeError("Second argument must be a String");if(!o.fn(i))throw new TypeError("Third argument must be a Function");if(o.node(t))return function(t,e,i){return t.addEventListener(e,i),{destroy:function(){t.removeEventListener(e,i)}}}(t,e,i);if(o.nodeList(t))return function(t,e,i){return Array.prototype.forEach.call(t,function(t){t.addEventListener(e,i)}),{destroy:function(){Array.prototype.forEach.call(t,function(t){t.removeEventListener(e,i)})}}}(t,e,i);if(o.string(t))return function(t,e,i){return n(document.body,t,e,i)}(t,e,i);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},{"./is":3,delegate:2}],5:[function(t,e,i){e.exports=function(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var i=t.hasAttribute("readonly");i||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),i||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var o=window.getSelection(),n=document.createRange();n.selectNodeContents(t),o.removeAllRanges(),o.addRange(n),e=o.toString()}return e}},{}],6:[function(t,e,i){function o(){}o.prototype={on:function(t,e,i){var o=this.e||(this.e={});return(o[t]||(o[t]=[])).push({fn:e,ctx:i}),this},once:function(t,e,i){function o(){n.off(t,o),e.apply(i,arguments)}var n=this;return o._=e,this.on(t,o,i)},emit:function(t){var e=[].slice.call(arguments,1),i=((this.e||(this.e={}))[t]||[]).slice(),o=0,n=i.length;for(o;o<n;o++)i[o].fn.apply(i[o].ctx,e);return this},off:function(t,e){var i=this.e||(this.e={}),o=i[t],n=[];if(o&&e)for(var s=0,r=o.length;s<r;s++)o[s].fn!==e&&o[s].fn._!==e&&n.push(o[s]);return n.length?i[t]=n:delete i[t],this}},e.exports=o},{}],7:[function(t,e,i){!function(o,n){if(void 0!==i)n(e,t("select"));else{var s={exports:{}};n(s,o.select),o.clipboardAction=s.exports}}(this,function(t,e){"use strict";var i=function(t){return t&&t.__esModule?t:{default:t}}(e),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.resolveOptions(e),this.initSelection()}return n(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var o=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=o+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,i.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,i.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":o(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=s})},{select:5}],8:[function(t,e,i){!function(o,n){if(void 0!==i)n(e,t("./clipboard-action"),t("tiny-emitter"),t("good-listener"));else{var s={exports:{}};n(s,o.clipboardAction,o.tinyEmitter,o.goodListener),o.clipboard=s.exports}}(this,function(t,e,i,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var i="data-clipboard-"+t;if(e.hasAttribute(i))return e.getAttribute(i)}var r=n(e),a=n(i),l=n(o),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),p=function(t){function e(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.resolveOptions(i),o.listenClick(t),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),h(e,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===c(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,l.default)(t,"click",function(t){return e.onClick(t)})}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new r.default({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return s("action",t)}},{key:"defaultTarget",value:function(t){var e=s("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return s("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,i=!!document.queryCommandSupported;return e.forEach(function(t){i=i&&!!document.queryCommandSupported(t)}),i}}]),e}();t.exports=p})},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)});