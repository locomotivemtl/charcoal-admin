/*! @locomotivemtl/charcoal-admin 01-05-2017 */
!function(a,b){var c,d,e;c=a.util.Tools.each,d=a.util.Tools.extend,e=a.util.Tools.isArray,a.create("tinymce.plugins.Charcoal",{dependencies:["advlist"],listItems:["bullist","numlist","outdent","indent"],alignItems:["alignleft","aligncenter","alignright","alignjustify"],editor:null,init:function(d){var f,g,h;f=this,this.editor=d,g=this.filterItems(this.listItems),h=this.filterItems(this.alignItems),d.addMenuItem("lists",{text:"Lists",context:"format",menu:g}),d.addMenuItem("alignment",{text:"Alignment",context:"format",menu:h}),d.addButton("alignment",{type:"menubutton",title:"Alignment",icon:f.getDefaultAlignment(),menu:h,onPostRender:function(){var a=this;d.on("NodeChange",function(b){var c,g;g=this.formatter.matchAll(f.alignItems),e(g)&&(g=g.pop()),g?"IMG"===b.element.nodeName&&(c=d.dom.getParent(b.element,"figure")||b.element,"alignnone"===g?a.active(!/\bu-align-(left|center|right)\b/.test(c.className)):a.active(d.dom.hasClass(c,g))):g=f.getDefaultAlignment(),a.icon(g)})}}),d.on("init",function(){var e,f,g,h;e=a.Env,f=d.getDoc(),g=d.dom,h=["charcoal-editor"],h.push("mceContentBody"),"rtl"===d.getParam("directionality")&&(h.push("rtl"),g.setAttrib(f.documentElement,"dir","rtl")),g.setAttrib(f.documentElement,"lang",d.getParam("root_lang_attr")),e.ie&&(9===parseInt(e.ie,10)?h.push("lt-ie10"):8===parseInt(e.ie,10)?h.push("lt-ie9"):e.ie<8&&h.push("lt-ie8")),c(h,function(a){a&&g.addClass(f.body,a)}),d.getParam("autohide_toolbar")&&b(d.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").hide(),d.getParam("autohide_menubar")&&b(d.getContentAreaContainer().parentElement).find("div.mce-menubar").hide()}),d.getParam("autohide_toolbar")&&(d.on("focus",function(){b(d.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").show()}),d.on("blur",function(){b(d.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").hide()})),d.getParam("autohide_menubar")&&(d.on("focus",function(){b(d.getContentAreaContainer().parentElement).find("div.mce-menubar").show()}),d.on("blur",function(){b(d.getContentAreaContainer().parentElement).find("div.mce-menubar").hide()})),d.getParam("image_dimensions")===!1&&d.on("NodeChange",function(b){b&&"img"===b.element.nodeName.toLowerCase()&&a.DOM.setAttribs(b.element,{width:null,height:null})})},getDefaultAlignment:function(){return"rtl"===this.editor.getParam("directionality")?"alignright":"alignleft"},filterItems:function(a){var b,f;return b=this.editor,f=[],e(a)||(a=a.split(" ")),c(a,function(a){var c;"|"===a?f.push({text:"-"}):a in b.buttons&&(c=d({},b.buttons[a]),c.text=c.tooltip,delete c.tooltip,delete c.type,f.push(c))}),f}}),a.PluginManager.add("charcoal",a.plugins.Charcoal,a.plugins.Charcoal.dependencies)}(window.tinymce,window.jQuery);